/*! For license information please see main.7704e7850c6e97cb1827.bundle.js.LICENSE.txt */
(()=>{var t,e={175:(t,e,s)=>{"use strict";s(260);var i,a,o,r=s(227);!function(t){t.BaseLevel="BaseLevel",t.PreloadStartScreen="PreloadStartScreen",t.StartScreen="StartScreen",t.PreloadTutorials="PreloadTutorials",t.Tutorials="Tutorials",t.PreloadLevel0="PreloadLevel0",t.Level0="Level0",t.PreloadLevel1="PreloadLevel1",t.Level1="Level1",t.PreloadLevel2="PreloadLevel2",t.Level2="Level2",t.PreloadLevel3="PreloadLevel3",t.Level3="Level3",t.PreloadLevel4="PreloadLevel4",t.Level4="Level4",t.PreloadLevel5="PreloadLevel5",t.Level5="Level5",t.PreloadLevel6="PreloadLevel6",t.Level6="Level6",t.PreloadLevel7="PreloadLevel7",t.Level7="Level7",t.PreloadLevel8="PreloadLevel8",t.Level8="Level8"}(i||(i={}));class n extends Phaser.Scene{constructor(){super({key:i.PreloadStartScreen})}preload(){const t=this.add.graphics(),e=this.add.graphics();e.fillStyle(2236962,.8),e.fillRect(140,240,320,50);const s=this.cameras.main.width,i=this.cameras.main.height,a=this.make.text({x:s/2,y:i/2-50,text:"Loading...",style:{font:"20px Pixels",color:"#ffffff"}});a.setOrigin(.5,.5);const o=this.make.text({x:s/2,y:i/2-30,text:"0%",style:{font:"18px Pixels",color:"#ffffff"}});o.setOrigin(.5,.5);const r=this.make.text({x:s/2,y:i/2+70,text:"",style:{font:"18px Pixels",color:"#ffffff"}});r.setOrigin(.5,.5),this.load.on("progress",(e=>{t.clear(),t.fillStyle(16777215,1),t.fillRect(140,240,300*e,30),o.setText(parseInt((100*e).toString())+"%")})),this.load.on("fileprogress",(t=>{const e=t.src.split("/"),s=e[e.length-1];r.setText("Loading asset: "+s)})),this.load.on("complete",(()=>{r.destroy(),o.destroy(),a.destroy(),t.destroy(),e.destroy(),this.load.off("progress"),this.load.off("fileprogress"),this.load.off("complete")})),this.load.json("translations","assets/json/options/translations.json"),this.load.scenePlugin({key:"rexUI",sceneKey:"rexUI"}),this.load.image("nextPage","assets/img/ui/arrow-down-left.png"),this.load.image("dialogEnd","assets/img/ui/cancel.png"),this.load.audio("death","assets/sounds/death.wav"),this.load.audio("door_tp","assets/sounds/door_tp.wav"),this.load.audio("simple_gun_shot","assets/sounds/simple_gun_shot.wav"),this.load.audio("levels","assets/sounds/levels.wav"),this.load.audio("tp","assets/sounds/tp.wav"),this.load.audio("walk","assets/sounds/walk.wav"),this.load.audio("switcher","assets/sounds/switcher.wav"),this.load.audio("door_open","assets/sounds/door_open.wav"),this.load.audio("door_close","assets/sounds/door_close.wav"),this.load.audio("end_level","assets/sounds/end_level.wav"),this.load.bitmapFont("pixels","assets/fonts/pixels.png","assets/fonts/pixels.xml.fnt"),this.load.image("tileset","assets/img/tileset.png"),this.load.image("title","assets/img/logo.png"),this.load.image("door_start","assets/img/objects/door_start.png"),this.load.image("door_end_open","assets/img/objects/door_end_open.png"),this.load.image("door_end_close","assets/img/objects/door_end_close.png"),this.load.image("door_tp_red","assets/img/objects/door_tp_red.png"),this.load.image("door_tp_green","assets/img/objects/door_tp_green.png"),this.load.image("door_tp_full_red","assets/img/objects/door_tp_full_red.png"),this.load.image("door_tp_full_green","assets/img/objects/door_tp_full_green.png"),this.load.image("tp_red","assets/img/objects/tp_red.png"),this.load.image("tp_red_close","assets/img/objects/tp_red_close.png"),this.load.image("tp_orange","assets/img/objects/tp_orange.png"),this.load.image("tp_orange_close","assets/img/objects/tp_orange_close.png"),this.load.image("tp_green","assets/img/objects/tp_green.png"),this.load.image("tp_green_close","assets/img/objects/tp_green_close.png"),this.load.image("switcher_red","assets/img/objects/switcher_red.png"),this.load.image("switcher_green","assets/img/objects/switcher_green.png"),this.load.image("switcher_orange","assets/img/objects/switcher_orange.png"),this.load.image("bool_white_on","assets/img/objects/bool_white_on.png"),this.load.image("bool_white_off","assets/img/objects/bool_white_off.png"),this.load.tilemapTiledJSON("tileset","assets/json/levels/game-screen.json"),this.load.atlas("player","assets/img/chars/player_atlas.png","assets/json/chars/player_atlas.json"),this.load.atlas("simple_bullet","assets/img/objects/simple_bullet_atlas.png","assets/json/objects/simple_bullet_atlas.json"),this.load.atlas("simple_gun_shot","assets/img/particles/simple_gun_shot.png","assets/json/particles/simple_gun_shot.json")}create(){this.scene.start(i.StartScreen)}}!function(t){t.DOOR_START="start",t.CORPSE="corpse",t.DOOR_END="end",t.START="start",t.END="end",t.DIALOG="dialog",t.STAIRS_DETECTION="stairs_detection",t.STAIRS_LINE="stairs_line",t.SPATIAL_DOOR="spatial_door"}(a||(a={})),function(t){t.EVENTS="events",t.DIALOGS="dialogs",t.SPATIAL_TELEPORTERS="spatial_teleporters",t.TIME_TELEPORTERS="time_teleporters",t.TIME_SWITCHERS="time_switchers",t.PLAYER="player",t.DOORS="doors",t.STAIRS_DETECTION="stairs_detection",t.CEILING="ceiling",t.LIGHTS="lights",t.OPTIONS="options",t.PLATFORMS="platforms",t.DESKS="desks",t.WALL2="wall2",t.WALL="wall",t.TP="tp",t.GROUND="ground",t.BACKGROUND="background",t.STAIRS="stairs",t.TITLE="title"}(o||(o={}));class h extends Phaser.Physics.Arcade.Sprite{constructor(t,e,s,i,a){super(t,e,s,i?"bool_white_on":"bool_white_off"),this.textContent=a,this.nextActivability=0,this.activabilityRate=500,this.isOn=i,this.setInteractive(),t.add.existing(this)}create(){this.on("pointerdown",(()=>{this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.activate())})),this.on("pointerover",(()=>{this.scene.sys.canvas.style.cursor="pointer"})),this.on("pointerout",(()=>{this.scene.sys.canvas.style.cursor="default"})),this.resolveState()}switch(){this.isOn=!this.isOn,this.resolveState(),this.scene.store.get("fx")&&this.scene.sound.play("switcher")}resolveState(){this.text&&this.text.destroy(),this.text=this.scene.add.text(Math.round(this.x),Math.round(this.y-30),this.textContent,{fontFamily:"Pixels",align:"left"}).setScale(1).setFontSize(15).setResolution(10).setOrigin(.5,.5),this.isOn&&(this.text.setColor("blue").setAlpha(1),this.setTexture("bool_white_on")),this.isOn||(this.text.setColor("red").setAlpha(.2),this.setTexture("bool_white_off"))}}class l extends h{constructor(t,e,s){const i=t.store.get("lang");super(t,e,s,null!==i&&"en"===i,"EN"),this.create()}create(){super.create(),this.scene.events.on("StartScreen::switchEn",(()=>{this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.activate())}),this)}activate(){this.switch(),this.scene.events.emit("StartScreen::switchFr"),this.isOn&&this.scene.store.set("lang","en")}}class c extends h{constructor(t,e,s){const i=t.store.get("lang");super(t,e,s,null===i||"fr"===i,"FR"),this.create()}create(){super.create(),this.scene.events.on("StartScreen::switchFr",(()=>{this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.activate())}),this)}activate(){this.switch(),this.scene.events.emit("StartScreen::switchEn"),this.isOn&&this.scene.store.set("lang","fr")}}class d extends h{constructor(t,e,s){const i=t.store.get("music");super(t,e,s,null==i||i,"MUSIC"),this.create()}create(){super.create(),this.scene.events.on("StartScreen::switchMusic",(()=>{this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.activate())}),this)}activate(){this.switch(),this.scene.store.set("music",this.isOn)}}class p extends Phaser.Physics.Arcade.Sprite{constructor(t,e,s,i){var a;super(t,e,s,"player","idle-1"),this.isMovable=!0,this.speedX=180,this.nextFire=0,this.fireRate=500,this.nextWalkSound=0,this.walkSoundRate=500,this.nextActivability=0,this.activabilityRate=500,this.hasFx=!0,this.isDeadEventEmitted=!1,this.isDead=!1,this.isClimbing=!1,this.currentstairsClimbingIndex=0,this.stairsGroup=this.scene.physics.add.staticGroup(),this.stairs=null!=i?i:[],this.hasFx=null===(a=this.scene.store.get("fx"))||void 0===a||a,t.add.existing(this),this.scene.physics.world.enable(this),this.setCollideWorldBounds(!0)}create(){this.initCharacs(),this.initKeyboardInputs(),this.initAnimations(),this.initBulletsGroups(),this.initStairs(),this.listenToSpatialTeleporterEvents(),this.listenToDoubleTimeTeleporterEvents(),this.listenToSimpleTimeTeleporterEvents(),this.listenToPastPlayerEvents(),this.listenToStoreEvents()}update(){this.checkForStairsOverlapOut(),this.on("animationcomplete",(()=>{this.isDead&&!this.isDeadEventEmitted&&(this.anims.stop(),this.scene.events.emit("Player::isDead"),this.isDeadEventEmitted=!0)})),this.movePlayer(),this.checkActions()}pause(){this.isMovable=!1}resume(){this.isMovable=!0}listenToPastPlayerEvents(){this.scene.events.on("PastPlayer::shotBullet",((t,e)=>{this.scene.physics.add.collider(this,t,(()=>{t.destroy(),this.isDead||(this.isMovable=!1,this.flipX="right"!==e,this.isDead=!0,this.body.enable=!1,this.hasFx&&this.scene.sound.play("death"),this.anims.play("death",!0),this.setVelocity(0))}),void 0,this)}),this)}checkForStairsOverlapOut(){this.stairsGroup.children.entries.forEach((()=>{this.isClimbing&&this.body.touching.none&&(this.isClimbing=!1,this.currentStairsClimbing=[],this.currentstairsClimbingIndex=0)}))}initStairs(){if(this.scene.physics.add.overlap(this,this.stairsGroup,this.overlapStairs,void 0,this),this.stairs.length>0)for(const t of this.stairs){const e={x:t.x,y:t.y},s=t.polyline[1],i={x:t.x+s.x,y:t.y+s.y},a=new Phaser.Curves.Line(new Phaser.Math.Vector2(e.x,e.y),new Phaser.Math.Vector2(i.x,i.y)),o=this.stairsGroup.create(a.getBounds().x,a.getBounds().y,void 0,void 0,!1);o.setScale(a.getBounds().width/32,a.getBounds().height/32),o.setOrigin(0),o.setDataEnabled(),o.setData("curve",a),o.body.width=a.getBounds().width,o.body.height=a.getBounds().height,this.stairsGroup.refresh()}}overlapStairs(t,e){if(!this.isClimbing){const t=e.getData("curve");this.currentStairsClimbing=t.getSpacedPoints(t.getLength()/7),this.isClimbing=!0}}listenToStoreEvents(){this.scene.events.on("Store::fx",(t=>{this.hasFx=t}))}initBulletsGroups(){this.bullets=this.scene.physics.add.group({defaultKey:"simple_bullet",allowGravity:!1,immovable:!0,frameQuantity:5})}initAnimations(){this.anims.create({key:"walk",frames:this.scene.anims.generateFrameNames("player",{prefix:"walk-",start:1,end:6}),frameRate:5,repeat:-1}),this.anims.create({key:"death",frames:this.scene.anims.generateFrameNames("player",{prefix:"death-",start:1,end:5}),frameRate:5,repeat:0}),this.anims.create({key:"shot",frames:this.scene.anims.generateFrameNames("player",{prefix:"shot-",start:1,end:3}),frameRate:5,repeat:-1}),this.anims.create({key:"simple_gun_shot",frames:this.scene.anims.generateFrameNames("simple_gun_shot",{prefix:"hits-1-",start:2,end:5}),frameRate:5,repeat:0}),this.scene.anims.create({key:"simple_bullet",frames:this.scene.anims.generateFrameNames("simple_bullet",{prefix:"simple-bullet-",start:1,end:4}),frameRate:5,repeat:-1})}listenToSimpleTimeTeleporterEvents(){this.scene.events.on("SimpleTimeTeleporter::activate",(({x:t,y:e})=>{this.scene.events.emit("Player::tps"),this.teleportOnCoordinates({x:t,y:e})}))}listenToDoubleTimeTeleporterEvents(){this.scene.events.on("DoubleTimeTeleporter::activate",((t,{x:e,y:s})=>{this.scene.events.emit("Player::tps"),this.teleportOnCoordinates({x:e,y:s})}))}listenToSpatialTeleporterEvents(){this.scene.events.on("SpatialTeleporter::teleport",(({x:t,y:e})=>{this.teleportOnCoordinates({x:t,y:e})}))}teleportOnCoordinates({x:t,y:e}){const s="left"===this.direction?t-10:t+10;this.setPosition(s,e),this.scene.events.emit("Player::canDetect")}checkActions(){this.isMovable?(this.enter.isDown?this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.enterActivate=!0):this.enterActivate=!1,this.shot.isDown?this.isShooting=!0:this.isShooting=!1,this.isShooting&&(this.anims.play("shot"),this.scene.time.now>this.nextFire&&(this.nextFire=this.scene.time.now+this.fireRate,"left"===this.direction&&this.shotBullet(-500),"right"===this.direction&&this.shotBullet(500)))):(this.enterActivate=!1,this.isShooting=!1)}shotBullet(t){this.hasFx&&this.scene.sound.play("simple_gun_shot",{volume:1});const e="left"===this.direction?this.x-12:this.x+12,s=this.scene.add.sprite(e,this.y,"simple_gun_shot");this.anims.play("simple_gun_shot"),this.scene.time.delayedCall(50,(()=>{this.anims.stop(),s.destroy()}));const i=this.bullets.get(this.x,this.y);i.anims.play("simple_bullet"),i.body.velocity.x=t,i.checkWorldBounds=!0,i.outOfBoundsKill=!0,this.scene.events.emit("Player::shotBullet",i,this.direction)}initCharacs(){this.body.setSize(2),this.setDepth(1),this.direction="right"}initKeyboardInputs(){this.left=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.LEFT),this.right=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.RIGHT),this.enter=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.ENTER),this.shot=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE)}intersectObjects(t,e){return(0,Phaser.Geom.Intersects.LineToRectangle)(e,t.getBounds())}movePlayer(){this.isMovable?(this.left.isDown?this.goLeft=!0:this.goLeft=!1,this.right.isDown?this.goRight=!0:this.goRight=!1,this.isShooting?this.setVelocityX(0):(this.goLeft||this.goRight?this.playWalk():this.isDead||this.playIdle(),this.goLeft?(this.flipLeft(),this.isClimbing?this.climbOnLeftDirection():this.setVelocityX(-this.speedX)):this.goRight?(this.flipRight(),this.isClimbing?this.climbOnRightDirection():this.setVelocityX(this.speedX)):this.setVelocityX(0))):this.isDead||this.playIdle()}climbOnRightDirection(){var t;if(this.setVelocityX(this.speedX/2),this.currentstairsClimbingIndex+1<=(null===(t=this.currentStairsClimbing)||void 0===t?void 0:t.length)){const t=this.currentStairsClimbing[this.currentstairsClimbingIndex];this.currentstairsClimbingIndex++,this.setPosition(t.x,t.y)}}climbOnLeftDirection(){var t;if(this.setVelocityX(-this.speedX/2),this.currentstairsClimbingIndex+1<=(null===(t=this.currentStairsClimbing)||void 0===t?void 0:t.length)){const t=this.currentStairsClimbing[this.currentStairsClimbing.length-1-this.currentstairsClimbingIndex];this.currentstairsClimbingIndex++,this.setPosition(t.x,t.y)}}flipRight(){this.flipX=!1,this.direction="right"}flipLeft(){this.flipX=!0,this.direction="left"}playIdle(){this.setVelocityX(0),this.anims.stop(),this.setTexture("player","idle-1")}playWalk(){this.anims.play("walk",!0),this.scene.time.now>this.nextWalkSound&&(this.nextWalkSound=this.scene.time.now+this.walkSoundRate,this.hasFx&&this.scene.sound.play("walk"))}}class u extends h{constructor(t,e,s){const i=t.store.get("fx");super(t,e,s,null==i||i,"FX"),this.create()}create(){super.create(),this.scene.events.on("StartScreen::switchFx",(()=>{this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.activate())}),this)}activate(){this.switch(),this.scene.store.set("fx",this.isOn),this.scene.events.emit("SoundSwitcher::fx",this.isOn)}}class y extends h{constructor(t,e,s){const i=t.store.get("tutorials");super(t,e,s,null==i||i,"TUTORIALS"),this.create()}create(){super.create(),this.scene.events.on("StartScreen::switchTutorials",(()=>{this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.activate())}),this)}activate(){this.switch(),this.scene.store.set("tutorials",this.isOn),this.scene.events.emit("TutorialsSwitcher::tutorials",this.isOn)}}class m{constructor(t,e,s){this.scene=t,this.x=e,this.y=s}get box(){return this.textBox}start(t){const e=1199753;this.textBox=this.scene.rexUI.add.textBox({x:this.x-18,y:this.y-60,background:this.createSpeechBubbleShape(this.scene,16777215,e),icon:this.scene.rexUI.add.roundRectangle(0,0,2,2,20,e),text:this.getBBcodeText(this.scene,425,600,425,100),action:this.scene.add.image(0,0,"nextPage").setTint(e).setVisible(!1),space:{left:20,right:20,top:20,bottom:20,icon:10,text:10}}).setOrigin(0).layout();const s=this.textBox;this.scene.input.keyboard.on("keydown-ENTER",(()=>{this.textBox.isTyping?this.textBox.stop(!0):this.textBox.isLastPage?this.destroy():this.textBox.typeNextPage()})),this.scene.input.keyboard.on("keydown-ESC",(()=>{this.destroy()})),this.textBox.setDepth(2).setInteractive().on("pageend",(()=>{const t=s.getElement("action");s.isLastPage&&t.setTexture("dialogEnd").setTint(e),t.setVisible(!0),s.resetChildVisibleState(t),t.y-=30,this.scene.tweens.add({targets:t,y:"+=30",ease:"Bounce",duration:500,repeat:0,yoyo:!1})})),this.textBox.start(t,50)}destroy(){this.scene.input.keyboard.off("keydown-ENTER"),this.scene.input.keyboard.off("keydown-ESC"),this.textBox.destroy(),this.scene.events.emit("MyTextBox::complete")}getBBcodeText(t,e,s,i,a){return t.rexUI.add.BBCodeText(0,0,"",{fixedWidth:i,fixedHeight:a,color:0,fontSize:"20px",wrap:{mode:"word",width:e,height:s},maxLines:4})}createSpeechBubbleShape(t,e,s){return t.rexUI.add.customShapes({create:{lines:1},update:function(){const t=20,i=this.width,a=this.height,o=a-15;this.getShapes()[0].lineStyle(2,s,1).fillStyle(e,1).startAt(20,0).lineTo(i-t,0).arc(i-t,20,t,270,360).lineTo(i,o-t).arc(i-t,o-t,t,0,90).lineTo(60,o).lineTo(50,a).lineTo(40,o).lineTo(20,o).arc(20,o-t,t,90,180).lineTo(0,20).arc(20,20,t,180,270).close()}})}}class g extends Phaser.Physics.Arcade.Sprite{constructor(t,e,s){super(t,e,s,"door_start"),this.setInteractive(),t.add.existing(this),this.create()}create(){this.scene.add.text(Math.round(this.x),Math.round(this.y-30),"NEW GAME",{fontFamily:"Pixels",align:"left"}).setScale(1).setFontSize(15).setResolution(10).setOrigin(.5,.5).setColor("blue"),this.on("pointerdown",(()=>{this.scene.events.emit("StartNewGame::go")})),this.on("pointerover",(()=>{this.scene.sys.canvas.style.cursor="pointer"})),this.on("pointerout",(()=>{this.scene.sys.canvas.style.cursor="default"}))}}class v extends Phaser.Physics.Arcade.Sprite{constructor(t,e,s){var i;const a=t.store.get("level");super(t,e,s,a?"door_start":"door_end_close"),this.setInteractive(),t.add.existing(this),this._isOpen=null!==a,this.hasFx=null===(i=this.scene.store.get("fx"))||void 0===i||i,this.create()}get isOpen(){return this._isOpen}create(){this.scene.events.on("Store::fx",(t=>{this.hasFx=t})),this.scene.add.text(Math.round(this.x),Math.round(this.y-30),"CONTINUE",{fontFamily:"Pixels",align:"left"}).setScale(1).setFontSize(15).setResolution(10).setOrigin(.5,.5).setColor("blue"),this.on("pointerdown",(()=>{this._isOpen||!this.hasFx?this.scene.events.emit("ContinueGame::go"):this.scene.sound.play("door_close")})),this.on("pointerover",(()=>{this.scene.sys.canvas.style.cursor="pointer"})),this.on("pointerout",(()=>{this.scene.sys.canvas.style.cursor="default"}))}}class x extends Phaser.Physics.Arcade.Sprite{constructor(t,e,s){super(t,e,s,"door_start"),this.setInteractive(),t.add.existing(this),this.create()}create(){this.scene.add.text(Math.round(this.x),Math.round(this.y-30),"TUTORIALS",{fontFamily:"Pixels",align:"left"}).setScale(1).setFontSize(15).setResolution(10).setOrigin(.5,.5).setColor("blue"),this.on("pointerdown",(()=>{this.scene.events.emit("TutorialsGame::go")})),this.on("pointerover",(()=>{this.scene.sys.canvas.style.cursor="pointer"})),this.on("pointerout",(()=>{this.scene.sys.canvas.style.cursor="default"}))}}class f extends Phaser.Scene{constructor(){super({key:i.StartScreen}),this.dialogs=new Map,this.isDialogLaunched=!1,this.nextActivability=0,this.activabilityRate=500,this.nextScene=i.PreloadLevel1,this.tilesetKey="tileset"}create(){var t,e;this.removeEvents(),this.hasFx=null===(t=this.store.get("fx"))||void 0===t||t,this.hasMusic=null===(e=this.store.get("music"))||void 0===e||e,this.musicHasBeenPlayed=!1,this.ballGroup=this.add.group(),this.initMap(),this.buildWhiteSwitchers(),this.initTutorialsGame(),this.listenToPlayerEvents(),this.listenToMyTextBoxEvents(),this.initPlayer(),this.launchMusic(),this.addDialog(0,this.translate.get(i.StartScreen,0)),this.listenToTutorialsGameEvents(),this.initAllowsTutorialsOption(),this.listenToMusicSwitcherEvents(),this.listenToTutorialsSwitcherEvents(),this.listenToFxButtonEvents()}update(){this.player.update(),this.checkForTutorials(),this.checkForOptions(),this.checkTutorialsGame()}listenToFxButtonEvents(){this.events.on("Store::fx",(t=>{this.hasFx=t}))}listenToStartNewGameEvents(){this.events.on("StartNewGame::go",(()=>{this.goLevel1()}))}listenToTutorialsGameEvents(){this.events.on("TutorialsGame::go",(()=>{this.goTutorials()}))}listenToContinueGameEvents(){this.events.on("ContinueGame::go",(()=>{this.goContinue()}))}removeEvents(){this.events.off("DoubleSwitcher::activate"),this.events.off("DoubleTimeTeleporter::activate"),this.events.off("StartScreen::switchFr"),this.events.off("StartScreen::switchEn"),this.events.off("SpatialTeleporter::teleport"),this.events.off("SpatialTeleporter::activate"),this.events.off("MultiSwitcher::activate"),this.events.off("MultiTimeTeleporter::setToOpen"),this.events.off("TutorialsGame::go"),this.events.off("StartNewGame::go"),this.events.off("ContinueGame::go"),this.events.off("PastPlayer::init"),this.events.off("PastPlayer::isDead"),this.events.off("Player::isDead"),this.events.off("Player::shotBullet"),this.events.off("PastPlayer::shotBullet"),this.events.off("Player::canDetect"),this.events.off("RedSpatialTeleporter::activate"),this.events.off("SimpleSwitcher::activate"),this.events.off("SimpleTimeTeleporter::activate"),this.events.off("SoundSwitcher::fx"),this.events.off("TutorialsSwitcher::tutorials"),this.events.off("Store::lang"),this.events.off("Store::music"),this.events.off("Store::tutorials"),this.events.off("Store::fx"),this.events.off("ExitButton::exit"),this.events.off("MyTextBox::complete"),this.events.off("ResetButton::reset"),this.events.off("DoubleSwitcher::activate"),this.events.off("StartScreen::switchMusic"),this.events.off("StartScreen::switchFx"),this.events.off("StartScreen::switchTutorials")}initContinueGame(){const t=this.utils.findObjectByLayerAndName(o.OPTIONS,"continue");t&&(this.continueGameCoordinates={x:t.x,y:t.y},this.continueGameDoor=new v(this,this.continueGameCoordinates.x,this.continueGameCoordinates.y))}initTutorialsGame(){const t=this.utils.findObjectByLayerAndName(o.OPTIONS,"tutorials");t&&(this.tutorialsCoordinates={x:t.x,y:t.y},new x(this,this.tutorialsCoordinates.x,this.tutorialsCoordinates.y))}initStartNewGame(){const t=this.utils.findObjectByLayerAndName(o.OPTIONS,"start");t&&(this.startNewGameCoordinates={x:t.x,y:t.y},new g(this,this.startNewGameCoordinates.x,this.startNewGameCoordinates.y))}buildWhiteSwitchers(){var t,e;const s=this.utils.filterObjectsByLayerAndName(o.OPTIONS,"bool-white");if(s.length>0)for(const i of s)switch(this.utils.getPropertiesAsObject(i).name){case"music":this.musicSwitcherCoordinates={x:i.x,y:i.y},new d(this,(null==i?void 0:i.x)||0,(null==i?void 0:i.y)||0);break;case"sound":this.soundSwitcherCoordinates={x:i.x,y:i.y},new u(this,(null==i?void 0:i.x)||0,(null==i?void 0:i.y)||0);break;case"fr":this.frSwitcherCoordinates={x:i.x,y:i.y},new c(this,(null==i?void 0:i.x)||0,(null==i?void 0:i.y)||0);break;case"en":this.enSwitcherCoordinates={x:i.x,y:i.y},new l(this,(null==i?void 0:i.x)||0,(null==i?void 0:i.y)||0);break;case"tutorials":this.tutorialsSwitcherCoordinates={x:null!==(t=i.x)&&void 0!==t?t:0,y:null!==(e=i.y)&&void 0!==e?e:0},new y(this,(null==i?void 0:i.x)||0,(null==i?void 0:i.y)||0)}}checkStartNewGame(){this.utils.coordinatesAreNear(this.startNewGameCoordinates,this.player)&&this.player.enterActivate&&this.goLevel1()}checkTutorialsGame(){this.utils.coordinatesAreNear(this.tutorialsCoordinates,this.player)&&this.player.enterActivate&&this.goTutorials()}checkContinueGame(){this.utils.coordinatesAreNear(this.continueGameCoordinates,this.player)&&this.player.enterActivate&&this.time.now>this.nextActivability&&(this.nextActivability=this.time.now+this.activabilityRate,this.continueGameDoor.isOpen||this.hasFx&&this.sound.play("door_close"),this.goContinue())}goLevel1(){this.hasFx&&this.sound.play("door_tp"),this.music.stop(),this.store.set("score",0),this.scene.start(i.PreloadLevel1)}goContinue(){const t=this.store.get("level");t&&(this.hasFx&&this.sound.play("door_tp"),this.music.stop(),this.scene.start(t))}goTutorials(){this.hasFx&&this.sound.play("door_tp"),this.music.stop(),this.scene.start(i.PreloadTutorials)}checkForOptions(){this.utils.coordinatesAreNear(this.musicSwitcherCoordinates,this.player)&&this.player.enterActivate&&this.events.emit("StartScreen::switchMusic"),this.utils.coordinatesAreNear(this.soundSwitcherCoordinates,this.player)&&this.player.enterActivate&&this.events.emit("StartScreen::switchFx"),this.utils.coordinatesAreNear(this.frSwitcherCoordinates,this.player)&&this.player.enterActivate&&this.events.emit("StartScreen::switchFr"),this.utils.coordinatesAreNear(this.enSwitcherCoordinates,this.player)&&this.player.enterActivate&&this.events.emit("StartScreen::switchEn"),this.utils.coordinatesAreNear(this.tutorialsSwitcherCoordinates,this.player)&&this.player.enterActivate&&this.events.emit("StartScreen::switchTutorials")}initPlayer(){var t,e;this.start=this.tilemap.findObject(o.PLAYER,(t=>t.name===a.START)),this.player=new p(this,(null===(t=this.start)||void 0===t?void 0:t.x)||0,(null===(e=this.start)||void 0===e?void 0:e.y)||0),this.player.create(),this.cameras.main.startFollow(this.player),this.cameras.main.setLerp(.1,.1),this.physics.add.collider(this.player,[this.groundLayer,this.platformsLayer])}addDialog(t,e){const{x:s,y:i}=this.tilemap.findObject("dialogs",(e=>e.properties[0].value===t));this.dialogs.set(JSON.stringify({x:s,y:i}),e)}startDialog(t){if(!this.isDialogLaunched){const e=this.cameras.main.worldView.x+25,s=this.cameras.main.worldView.y+this.cameras.main.height/2;this.textBox=new m(this,e,s),this.textBox.start(t),this.player.pause(),this.isDialogLaunched=!0}}listenToPlayerEvents(){this.events.on("Player::shotBullet",(t=>{this.events.emit("StartScreen::firstShotGun"),this.ballGroup.add(t),this.physics.add.collider([this.groundLayer],t,(()=>{t.destroy()}))}),this)}listenToMyTextBoxEvents(){this.events.on("MyTextBox::complete",(()=>{this.isDialogLaunched=!1,this.time.delayedCall(500,(()=>{this.player.resume()}))}),this)}initMap(){this.tilemap=this.add.tilemap(this.tilesetKey),this.tileset=this.tilemap.addTilesetImage("tileset","tileset");const t=this.tilemap.addTilesetImage("title","title");this.bckgLayer=this.tilemap.createLayer(o.BACKGROUND,this.tileset,0,0),this.groundLayer=this.tilemap.createLayer(o.GROUND,this.tileset,0,0),this.wallLayer=this.tilemap.createLayer(o.WALL,this.tileset,0,0),this.wall2Layer=this.tilemap.createLayer(o.WALL2,this.tileset,0,0),this.desksLayer=this.tilemap.createLayer(o.DESKS,this.tileset,0,0),this.platformsLayer=this.tilemap.createLayer(o.PLATFORMS,this.tileset,0,0),this.ceilingLayer=this.tilemap.createLayer(o.CEILING,this.tileset,0,0),this.lightsLayer=this.tilemap.createLayer(o.LIGHTS,this.tileset,0,0),this.tpLayer=this.tilemap.createLayer(o.TP,this.tileset,0,0),this.titleLayer=this.tilemap.createLayer(o.TITLE,t,0,0),this.groundLayer.setCollisionByProperty({collides:!0}),this.platformsLayer.setCollisionByProperty({collides:!0}),this.cameras.main.setBounds(0,0,this.tilemap.widthInPixels,this.tilemap.heightInPixels),this.physics.world.setBounds(0,0,this.tilemap.widthInPixels,this.tilemap.heightInPixels),this.utils.init(this.tilemap)}checkForTutorials(){this.allowsTutorials&&this.dialogs.forEach(((t,e)=>{const{x:s,y:i}=JSON.parse(e);this.isDialogLaunched||this.player.x>(s||0)-10&&this.player.x<(s||0)+10&&this.player.y>(i||0)-10&&this.player.y<(i||0)+10&&(this.startDialog(t),this.dialogs.delete(e))}))}launchMusic(){this.music=this.sound.add("levels"),this.hasMusic&&!this.music.isPlaying&&(this.musicHasBeenPlayed=!0,this.music.play({loop:!0,volume:.1}))}listenToMusicSwitcherEvents(){this.events.on("Store::music",(t=>{this.hasMusic=t,t||this.music.pause(),t&&(this.musicHasBeenPlayed&&this.music.resume(),this.musicHasBeenPlayed||this.launchMusic())}))}initAllowsTutorialsOption(){const t=this.store.get("tutorials");null!==t&&(this.allowsTutorials=t),null===t&&(this.allowsTutorials=!0)}listenToTutorialsSwitcherEvents(){this.events.on("TutorialsSwitcher::tutorials",(t=>{this.allowsTutorials=t}))}}class T extends Phaser.Plugins.ScenePlugin{constructor(t,e){super(t,e,"utils")}init(t){this.tilemap=t}filterObjectsByLayerAndProperties(t,e){const s=this.tilemap.filterObjects(t,(t=>{const s=this.getPropertiesAsObject(t);return!!s&&Object.keys(e).every((t=>s[t]===e[t]))}));if(!s)throw new Error(`Objects with properties ${JSON.stringify(e)} not found in layer ${t}`);return s}findObjectByLayerAndName(t,e){const s=this.tilemap.findObject(t,(t=>t.name===e));if(!s)throw new Error(`Object with name ${e} not found in layer ${t}`);return s}filterObjectsByLayerAndName(t,e){const s=this.tilemap.filterObjects(t,(t=>t.name===e));if(!s)throw new Error(`Objects with name ${e} not found in layer ${t}`);return s}getPropertiesAsObject(t){return t.properties?t.properties.reduce(((t,e)=>Object.assign(Object.assign({},t),{[e.name]:e.value})),{}):null}coordinatesAreNear(t,e,s=10){const i=t.x-e.x,a=t.y-e.y,o=Math.sqrt(i*i+a*a);return Math.abs(o)<s}findObjectOnGroupByData(t,e){if((null==t?void 0:t.getLength())>0)return t.children.getArray().find((t=>Object.keys(e).every((s=>t.getData(s)===e[s]))));throw new Error(`Object not found with data ${JSON.stringify(e)}`)}iterateOnGroup(t,e){(null==t?void 0:t.getLength())>0&&t.children.iterate(e)}findObjectOnGroup(t,e){return(null==t?void 0:t.getLength())>0&&t.children.getArray().find(e)}intersectObjects(t,e){return(0,Phaser.Geom.Intersects.RectangleToRectangle)(t.getBounds(),e.getBounds())}findObjectByLayerAndProperties(t,e){const s=this.tilemap.findObject(t,(t=>{const s=this.getPropertiesAsObject(t);return Object.keys(e).every((t=>s[t]===e[t]))}));if(!s)throw new Error(`Object with properties ${JSON.stringify(e)} not found in layer ${t}`);return s}getMiddleSceneCoordinates(){return{x:this.scene.cameras.main.worldView.x+this.scene.cameras.main.width/2,y:this.scene.cameras.main.worldView.y+this.scene.cameras.main.height/2}}shakeOnTpCollision(){this.scene.cameras.main.shake(50,.01)}}class b extends Phaser.Plugins.ScenePlugin{constructor(t,e){super(t,e,"store"),this.prefix="paradoxe-game."}set(t,e){localStorage.setItem(this.prefix+t,JSON.stringify(e)),this.scene.events.emit("Store::"+t,e)}get(t){const e=localStorage.getItem(this.prefix+t);return e?JSON.parse(e):null}remove(t){localStorage.removeItem(this.prefix+t)}}class S extends Phaser.Plugins.ScenePlugin{constructor(t,e){super(t,e,"translate")}get(t,e){var s,i,a;if(this.translations||(this.translations=this.scene.cache.json.get("translations")),this.lang=null!==(s=this.scene.store.get("lang"))&&void 0!==s?s:"fr",!(null===(a=null===(i=this.translations[t])||void 0===i?void 0:i[this.lang])||void 0===a?void 0:a[e]))throw new Error(`translation not found for key ${t} and index ${e}`);return this.translations[t][this.lang][e]}}class w extends Phaser.Scene{constructor(t,e,s){super({key:t}),this.nextScene=e,this.tilesetKey=s,this.key=t}preload(){const t=this.add.graphics(),e=this.add.graphics();e.fillStyle(2236962,.8),e.fillRect(140,240,320,50);const s=this.cameras.main.width,i=this.cameras.main.height,a=this.make.text({x:s/2,y:i/2-50,text:"Loading...",style:{font:"20px Pixels",color:"#ffffff"}});a.setOrigin(.5,.5);const o=this.make.text({x:s/2,y:i/2-30,text:"0%",style:{font:"18px Pixels",color:"#ffffff"}});o.setOrigin(.5,.5);const r=this.make.text({x:s/2,y:i/2+70,text:"",style:{font:"18px Pixels",color:"#ffffff"}});r.setOrigin(.5,.5),this.load.on("progress",(e=>{t.clear(),t.fillStyle(16777215,1),t.fillRect(140,240,300*e,30),o.setText(parseInt((100*e).toString())+"%")})),this.load.on("fileprogress",(t=>{const e=t.src.split("/"),s=e[e.length-1];r.setText("Loading asset: "+s)})),this.load.on("complete",(()=>{r.destroy(),o.destroy(),a.destroy(),t.destroy(),e.destroy(),this.load.off("progress"),this.load.off("fileprogress"),this.load.off("complete")})),this.load.json("translations","assets/json/options/translations.json"),this.load.scenePlugin({key:"rexUI",sceneKey:"rexUI"}),this.load.image("nextPage","assets/img/ui/arrow-down-left.png"),this.load.image("dialogEnd","assets/img/ui/cancel.png"),this.load.audio("death","assets/sounds/death.wav"),this.load.audio("door_tp","assets/sounds/door_tp.wav"),this.load.audio("simple_gun_shot","assets/sounds/simple_gun_shot.wav"),this.load.audio("levels","assets/sounds/levels.wav"),this.load.audio("tp","assets/sounds/tp.wav"),this.load.audio("walk","assets/sounds/walk.wav"),this.load.audio("switcher","assets/sounds/switcher.wav"),this.load.audio("door_open","assets/sounds/door_open.wav"),this.load.audio("door_close","assets/sounds/door_close.wav"),this.load.audio("end_level","assets/sounds/end_level.wav"),this.load.image("tileset","assets/img/tileset.png"),this.load.image("door_start","assets/img/objects/door_start.png"),this.load.image("door_end_open","assets/img/objects/door_end_open.png"),this.load.image("door_end_close","assets/img/objects/door_end_close.png"),this.load.image("door_tp_red","assets/img/objects/door_tp_red.png"),this.load.image("door_tp_green","assets/img/objects/door_tp_green.png"),this.load.image("door_tp_full_red","assets/img/objects/door_tp_full_red.png"),this.load.image("door_tp_full_green","assets/img/objects/door_tp_full_green.png"),this.load.image("tp_red","assets/img/objects/tp_red.png"),this.load.image("tp_red_close","assets/img/objects/tp_red_close.png"),this.load.image("tp_orange","assets/img/objects/tp_orange.png"),this.load.image("tp_orange_close","assets/img/objects/tp_orange_close.png"),this.load.image("tp_green","assets/img/objects/tp_green.png"),this.load.image("tp_green_close","assets/img/objects/tp_green_close.png"),this.load.image("switcher_red","assets/img/objects/switcher_red.png"),this.load.image("switcher_green","assets/img/objects/switcher_green.png"),this.load.image("switcher_orange","assets/img/objects/switcher_orange.png"),this.load.image("reset","assets/img/ui/return.png"),this.load.image("exit","assets/img/ui/exit.png"),this.load.image("audio_on","assets/img/ui/audioOn.png"),this.load.image("audio_off","assets/img/ui/audioOff.png"),this.load.image("music_on","assets/img/ui/musicOn.png"),this.load.image("music_off","assets/img/ui/musicOff.png"),this.load.tilemapTiledJSON(this.tilesetKey,`assets/json/levels/${this.tilesetKey}.json`),this.load.atlas("player","assets/img/chars/player_atlas.png","assets/json/chars/player_atlas.json"),this.load.atlas("past_player","assets/img/chars/past_player_atlas.png","assets/json/chars/past_player_atlas.json"),this.load.atlas("simple_bullet","assets/img/objects/simple_bullet_atlas.png","assets/json/objects/simple_bullet_atlas.json"),this.load.atlas("simple_gun_shot","assets/img/particles/simple_gun_shot.png","assets/json/particles/simple_gun_shot.json")}create(){this.key!==i.PreloadTutorials&&this.store.set("level",this.key),this.scene.start(this.nextScene)}}class _ extends Phaser.Physics.Arcade.Sprite{constructor(t,e,s){super(t,e,s,"door_start"),t.add.existing(this)}}class P extends Phaser.Physics.Arcade.Sprite{constructor(t,e,s){var i;super(t,e,s,"door_end_open"),t.add.existing(this),this.hasFx=null===(i=this.scene.store.get("fx"))||void 0===i||i,this.create()}create(){this.scene.events.on("Store::fx",(t=>{this.hasFx=t}))}open(){this.setTexture("door_end_open"),this.hasFx&&this.scene.sound.play("door_open")}close(){this.setTexture("door_end_close"),this.hasFx&&this.scene.sound.play("door_close")}}class O extends Phaser.Physics.Arcade.Sprite{constructor(t,e,s,i,a){var o;super(t,e,s,"switcher_red"),this.group=i,this.num=a,this.nextActivability=0,this.activabilityRate=500,t.add.existing(this),this.hasFx=null===(o=this.scene.store.get("fx"))||void 0===o||o,this.create()}create(){this.scene.events.on("Store::fx",(t=>{this.hasFx=t}))}activate(){this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.hasFx&&this.scene.sound.play("switcher"),this.scene.events.emit("DoubleSwitcher::activate",this.group))}}class L extends Phaser.Physics.Arcade.Sprite{constructor(t,e,s,i,a){var o;super(t,e,s,"tp_red"),this.group=i,this.num=a,this.collidersGroup=[],this.alive=!0,t.add.existing(this),this.scene.physics.world.enable(this),this.setImmovable(!0),this.hasFx=null===(o=this.scene.store.get("fx"))||void 0===o||o,this.create()}create(){this.scene.events.on("DoubleSwitcher::activate",(t=>{this.alive&&this.group===t&&(this.alive=!1,this.setTexture("tp_red_close"),this.collidersGroup.forEach((t=>this.scene.physics.world.removeCollider(t))))})),this.scene.events.on("Store::fx",(t=>{this.hasFx=t}))}addColliders(...t){this.collidersGroup.push(...t)}addOpposite(t){this.oppositeDoubleTimeTeleporter=t}activate(){this.hasFx&&this.scene.sound.play("tp"),this.scene.events.emit("DoubleTimeTeleporter::activate",{x:this.x,y:this.y},this.getOppositeCoordinates())}getOppositeCoordinates(){const{x:t,y:e}=this.oppositeDoubleTimeTeleporter;return{x:t,y:e}}}class A extends Phaser.Physics.Arcade.Sprite{constructor(t,e,s,i,a){var o;super(t,e,s,"switcher_orange"),this.group=i,this.num=a,this.nextActivability=0,this.activabilityRate=500,t.add.existing(this),this.hasFx=null===(o=this.scene.store.get("fx"))||void 0===o||o,this.create()}create(){this.scene.events.on("Store::fx",(t=>{this.hasFx=t}))}activate(){this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.hasFx&&this.scene.sound.play("switcher"),this.scene.events.emit("MultiSwitcher::activate",this.group,this.num))}}class E extends Phaser.Physics.Arcade.Sprite{constructor(t,e,s,i,a,o){var r;super(t,e,s,"tp_orange"),this.group=i,this.num=a,this.close=o,this.collidersGroup=[],this.oppositeMultiTimeTeleporters=[],this._alive=!0,t.add.existing(this),this.scene.physics.world.enable(this),this.setImmovable(!0),this.hasFx=null===(r=this.scene.store.get("fx"))||void 0===r||r,this.create()}get alive(){return this._alive}set alive(t){this._alive=t}create(){this.scene.events.on("MultiSwitcher::activate",((t,e)=>{if(t===this.group&&e===this.num){const t=this.oppositeMultiTimeTeleporters.find((t=>t.alive)),e=this.oppositeMultiTimeTeleporters.find((t=>!t.alive));t&&t.setToClose(),this.alive?e&&e.setToOpen():this.setToOpen();const s=this.oppositeMultiTimeTeleporters.shift();this.oppositeMultiTimeTeleporters.push(s)}})),this.scene.events.on("Store::fx",(t=>{this.hasFx=t}))}setToOpen(){this.alive=!0,this.setTexture("tp_orange"),this.scene.events.emit("MultiTimeTeleporter::setToOpen",this.group,this.num)}setToClose(){this.alive=!1,this.setTexture("tp_orange_close"),this.collidersGroup.filter((t=>t.active)).forEach((t=>t.destroy()))}addColliders(...t){this.collidersGroup.push(...t)}addOpposites(...t){this.oppositeMultiTimeTeleporters.push(...t)}activate(){this.hasFx&&this.scene.sound.play("tp"),this.scene.events.emit("DoubleTimeTeleporter::activate",{x:this.x,y:this.y},this.getOppositeCoordinates())}getOppositeCoordinates(){const t=this.oppositeMultiTimeTeleporters.find((t=>t.alive))||this.oppositeMultiTimeTeleporters[0],{x:e,y:s}=t;return{x:e,y:s}}}class D extends Phaser.Physics.Arcade.Sprite{constructor(t,e,s,i,a,o){super(t,e,s,i),this.group=a,this.num=o,this._nextTp=0,this._tpRate=500,t.add.existing(this),this.create()}get nextTp(){return this._nextTp}set nextTp(t){this._nextTp=t}get tpRate(){return this._tpRate}create(){this.scene.events.on("SpatialTeleporter::activate",((t,e,s)=>{this.num===e&&this.group===t&&(this.nextTp=s,this.scene.events.emit("SpatialTeleporter::teleport",{x:this.x,y:this.y}))})),this.scene.events.on("Store::fx",(t=>{this.hasFx=t}))}activate(){if(this.scene.time.now>this.nextTp){this.nextTp=this.scene.time.now+this.tpRate;const t=0===this.num?1:0;this.hasFx&&this.scene.sound.play("door_tp"),this.scene.events.emit("SpatialTeleporter::activate",this.group,t,this.nextTp)}}}class G extends Phaser.Physics.Arcade.Sprite{constructor(t,e,s,i){var a;super(t,e,s,"past_player","idle-1"),this.player=i,this.isDead=!1,this.isDeadEventEmitted=!1,this.nextFire=0,this.fireRate=500,this.hasFx=!0,this.turnRight=!0,this.turnLeft=!1,this.canDetectPlayer=!1,this.hasDetected=!1,t.add.existing(this),this.scene.physics.world.enable(this),this.setCollideWorldBounds(!0),this.hasFx=null===(a=this.scene.store.get("fx"))||void 0===a||a,this.direction="left",this.setDepth(1),this.create()}create(){this.init(),this.scene.events.emit("PastPlayer::init"),this.initBulletsGroups(),this.anims.create({key:"walk",frames:this.scene.anims.generateFrameNames("past_player",{prefix:"walk-",start:1,end:6}),frameRate:5,repeat:-1}),this.anims.create({key:"death",frames:this.scene.anims.generateFrameNames("past_player",{prefix:"death-",start:1,end:5}),frameRate:5,repeat:0}),this.anims.create({key:"shot",frames:this.scene.anims.generateFrameNames("past_player",{prefix:"shot-",start:1,end:3}),frameRate:5,repeat:0}),this.anims.create({key:"simple_gun_shot",frames:this.scene.anims.generateFrameNames("simple_gun_shot",{prefix:"hits-1-",start:2,end:5}),frameRate:5,repeat:0}),this.anims.create({key:"simple_bullet",frames:this.scene.anims.generateFrameNames("simple_bullet",{prefix:"simple-bullet-",start:1,end:4}),frameRate:5,repeat:-1}),this.scene.events.on("Player::shotBullet",((t,e)=>{this.scene.physics.add.collider(this,t,(()=>{t.destroy(),this.isDead||(this.flipX="left"!==e,this.isDead=!0,this.body.enable=!1,this.hasFx&&this.scene.sound.play("death"),this.anims.play("death",!0),this.setVelocity(0))}),void 0,this)}),this),this.scene.events.on("Player::canDetect",(()=>{this.hasDetected=!1})),this.scene.events.on("Store::fx",(t=>{this.hasFx=t}))}update(){if(this.on("animationcomplete",(()=>{this.isDead&&!this.isDeadEventEmitted&&(this.anims.stop(),this.scene.events.emit("PastPlayer::isDead"),this.isDeadEventEmitted=!0)})),!this.isDead){const t=this.calculateDistanceWithPlayer();this.canDetectPlayer=t<150&&this.player.y===this.y,this.canDetectPlayer||(this.hasDetected=!1),!this.hasDetected&&this.canDetectPlayer&&this.detectPlayer()}}calculateDistanceWithPlayer(){const t=this.x-this.player.x,e=this.y-this.player.y,s=Math.sqrt(t*t+e*e);return Math.abs(s)}detectPlayer(){!this.hasDetected&&this.player.x<this.x&&(this.turnLeft=!0,this.turnRight=!1,this.hasDetected=!0,this.scene.time.delayedCall(2e3,(()=>{!this.isDead&&this.canDetectPlayer&&(this.flipX=!0,this.direction="right",this.hasDetected=!1,this.shoot())}))),!this.hasDetected&&this.player.x>this.x&&(this.turnRight=!0,this.turnLeft=!1,this.hasDetected=!0,this.scene.time.delayedCall(2e3,(()=>{!this.isDead&&this.canDetectPlayer&&(this.flipX=!1,this.direction="left",this.shoot(),this.hasDetected=!1)})))}shoot(){this.isDead||(this.anims.play("shot"),this.scene.time.now>this.nextFire&&(this.nextFire=this.scene.time.now+this.fireRate,"right"===this.direction&&this.shotBullet(-500),"left"===this.direction&&this.shotBullet(500)))}initBulletsGroups(){this.bullets=this.scene.physics.add.group({defaultKey:"simple_bullet",allowGravity:!1,immovable:!0,frameQuantity:5})}shotBullet(t){this.hasFx&&this.scene.sound.play("simple_gun_shot",{volume:1});const e="right"===this.direction?this.x-12:this.x+12,s=this.scene.add.sprite(e,this.y,"simple_gun_shot");s.anims.play("simple_gun_shot"),this.scene.time.delayedCall(50,(()=>{this.anims.stop(),s.destroy()}));const i=this.bullets.get(this.x,this.y);i.anims.play("simple_bullet"),i.body.velocity.x=t,i.checkWorldBounds=!0,i.outOfBoundsKill=!0,this.scene.events.emit("PastPlayer::shotBullet",i,this.direction),this.scene.time.delayedCall(500,(()=>{this.isDead||(this.anims.stop(),this.setTexture("past_player","idle-1"))}))}init(){this.body.setSize(2)}}class C extends Phaser.Physics.Arcade.Sprite{constructor(t,e,s,i,a){var o;super(t,e,s,"switcher_green"),this.group=i,this.num=a,this.nextActivability=0,this.activabilityRate=500,t.add.existing(this),this.hasFx=null===(o=this.scene.store.get("fx"))||void 0===o||o,this.create()}create(){this.scene.events.on("Store::fx",(t=>{this.hasFx=t}))}activate(){this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.hasFx&&this.scene.sound.play("switcher"),this.scene.events.emit("SimpleSwitcher::activate",this.group))}}class R extends Phaser.Physics.Arcade.Sprite{constructor(t,e,s,i){var a;super(t,e,s,"tp_green"),this.group=i,this.collidersGroup=[],this.alive=!0,t.add.existing(this),this.scene.physics.world.enable(this),this.setImmovable(!0),this.hasFx=null===(a=this.scene.store.get("fx"))||void 0===a||a,this.create()}create(){this.scene.events.on("SimpleSwitcher::activate",(t=>{this.alive&&this.group===t&&(this.alive=!1,this.setTexture("tp_green_close"),this.collidersGroup.forEach((t=>this.scene.physics.world.removeCollider(t))))})),this.scene.events.on("Store::fx",(t=>{this.hasFx=t}))}addColliders(...t){this.collidersGroup.push(...t)}activate(){this.hasFx&&this.scene.sound.play("tp"),this.scene.events.emit("SimpleTimeTeleporter::activate",{x:this.x,y:this.y})}}class j extends Phaser.Physics.Arcade.Sprite{constructor(t,e,s){super(t,e,s,"exit"),this.nextActivability=0,this.activabilityRate=500,t.add.existing(this),this.setInteractive(),this.setScrollFactor(0),this.setScale(.5),this.create()}create(){this.on("pointerdown",(()=>{this.activate()})),this.on("pointerover",(()=>{this.scene.sys.canvas.style.cursor="pointer"})),this.on("pointerout",(()=>{this.scene.sys.canvas.style.cursor="default"}))}activate(){this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.scene.events.emit("ExitButton::exit"),this.scene.store.get("fx")&&this.scene.sound.play("switcher"))}}class B extends Phaser.Physics.Arcade.Sprite{constructor(t,e,s){const i=t.store.get("fx");super(t,e,s,i?"audio_on":"audio_off"),this.nextActivability=0,this.activabilityRate=500,t.add.existing(this),this.setInteractive(),this.setScrollFactor(0),this.setScale(.5),this.create()}create(){this.on("pointerdown",(()=>{this.activate()})),this.on("pointerover",(()=>{this.scene.sys.canvas.style.cursor="pointer"})),this.on("pointerout",(()=>{this.scene.sys.canvas.style.cursor="default"}))}activate(){if(this.scene.time.now>this.nextActivability){this.nextActivability=this.scene.time.now+this.activabilityRate;const t=this.scene.store.get("fx");this.scene.store.set("fx",!t),t||this.setTexture("audio_on"),t&&this.setTexture("audio_off"),t&&this.scene.sound.play("switcher")}}}class k extends Phaser.Physics.Arcade.Sprite{constructor(t,e,s){const i=t.store.get("music");super(t,e,s,i?"music_on":"music_off"),this.nextActivability=0,this.activabilityRate=500,t.add.existing(this),this.setInteractive(),this.setScrollFactor(0),this.setScale(.5),this.create()}create(){this.on("pointerdown",(()=>{this.activate()})),this.on("pointerover",(()=>{this.scene.sys.canvas.style.cursor="pointer"})),this.on("pointerout",(()=>{this.scene.sys.canvas.style.cursor="default"}))}activate(){if(this.scene.time.now>this.nextActivability){this.nextActivability=this.scene.time.now+this.activabilityRate;const t=this.scene.store.get("music");this.scene.store.set("music",!t),t||this.setTexture("music_on"),t&&this.setTexture("music_off"),this.scene.store.get("fx")&&this.scene.sound.play("switcher")}}}class F extends Phaser.Physics.Arcade.Sprite{constructor(t,e,s){super(t,e,s,"reset"),this.nextActivability=0,this.activabilityRate=500,t.add.existing(this),this.setInteractive(),this.setScrollFactor(0),this.setScale(.5),this.create()}create(){this.on("pointerdown",(()=>{this.activate()})),this.on("pointerover",(()=>{this.scene.sys.canvas.style.cursor="pointer"})),this.on("pointerout",(()=>{this.scene.sys.canvas.style.cursor="default"}))}activate(){this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.scene.events.emit("ResetButton::reset"),this.scene.store.get("fx")&&this.scene.sound.play("switcher"))}}class I{constructor(t,e,s){this.scene=t,this.x=e,this.y=s;const i=t.store.get("score");this.score=null!=i?i:0,this.create()}create(){this.updatetext(),this.scene.events.on("Player::tps",(()=>{this.score++,this.scene.store.set("score",this.score),this.updatetext()}))}updatetext(){this.text&&this.text.destroy(),this.text=this.scene.add.text(Math.round(this.x),Math.round(this.y-30),"SCORE:"+this.score,{fontFamily:"Pixels",align:"left"}).setScale(1).setFontSize(30).setResolution(10).setOrigin(.5,.5).setColor("white").setScrollFactor(0)}}class M{constructor(t){new j(t,30,60),new F(t,80,60),new k(t,130,60),new B(t,180,60),new I(t,280,94)}}class N extends Phaser.Scene{constructor(t,e,s){super({key:t}),this.nextScene=e,this.tilesetKey=s,this.dialogs=new Map,this.isDialogLaunched=!1,this.nextActivability=0,this.activabilityRate=500,this.key=t}create(){var t,e,s;this.removeEvents(),this.hasFx=null===(t=this.store.get("fx"))||void 0===t||t,this.hasMusic=null===(e=this.store.get("music"))||void 0===e||e,this.currentScore=null!==(s=this.store.get("score"))&&void 0!==s?s:0,this.musicHasBeenPlayed=!1,this.ballGroup=this.add.group(),this.spatialTeleportersGroup=this.add.group(),this.simpleTimeTeleporterGroup=this.add.group(),this.simpleSwitcherGroup=this.add.group(),this.doubleTimeTeleportersGroup=this.add.group(),this.doubleSwitchersGroup=this.add.group(),this.multiTimeTeleportersGroup=this.add.group(),this.multiSwitchersGroup=this.add.group(),this.initMap(),this.initDoors(),this.initPastPlayers(),this.initTopBarUI(),this.listenToPlayerEvents(),this.listenToPastPlayersEvents(),this.listenToMyTextBoxEvents(),this.launchMusic(),this.initAllowsTutorialsOption(),this.listenToTutorialsSwitcherEvents(),this.listenToResetButtonEvents(),this.listenToExitButtonEvents(),this.listenToFxButtonEvents(),this.listenToMusicButtonEvents(),this.initPlayer(),this.createSpatialTeleporters(),this.createTimeTeleporters(),this.createTimeSwitchers()}update(t,e){this.player.update(),this.pastPlayersGroup.preUpdate(t,e),this.checkForTutorials(),this.checkForLevelEnd(),this.checkForTeleportersActivation()}initTopBarUI(){new M(this)}removeEvents(){this.events.off("DoubleSwitcher::activate"),this.events.off("DoubleTimeTeleporter::activate"),this.events.off("StartScreen::switchFr"),this.events.off("StartScreen::switchEn"),this.events.off("SpatialTeleporter::teleport"),this.events.off("SpatialTeleporter::activate"),this.events.off("MultiSwitcher::activate"),this.events.off("MultiTimeTeleporter::setToOpen"),this.events.off("TutorialsGame::go"),this.events.off("StartNewGame::go"),this.events.off("ContinueGame::go"),this.events.off("PastPlayer::init"),this.events.off("PastPlayer::isDead"),this.events.off("Player::isDead"),this.events.off("Player::canDetect"),this.events.off("Player::shotBullet"),this.events.off("PastPlayer::shotBullet"),this.events.off("RedSpatialTeleporter::activate"),this.events.off("SimpleSwitcher::activate"),this.events.off("SimpleTimeTeleporter::activate"),this.events.off("SoundSwitcher::fx"),this.events.off("TutorialsSwitcher::tutorials"),this.events.off("Store::lang"),this.events.off("Store::music"),this.events.off("Store::tutorials"),this.events.off("Store::fx"),this.events.off("ExitButton::exit"),this.events.off("MyTextBox::complete"),this.events.off("ResetButton::reset"),this.events.off("DoubleSwitcher::activate"),this.events.off("StartScreen::switchMusic"),this.events.off("StartScreen::switchFx"),this.events.off("StartScreen::switchTutorials")}listenToMusicButtonEvents(){this.events.on("Store::music",(t=>{this.hasMusic=t,t||this.music.pause(),t&&(this.musicHasBeenPlayed&&this.music.resume(),this.musicHasBeenPlayed||this.launchMusic())}))}listenToFxButtonEvents(){this.events.on("Store::fx",(t=>{this.hasFx=t}))}listenToResetButtonEvents(){this.events.on("ResetButton::reset",(()=>{this.store.set("score",this.currentScore),this.music.stop(),this.scene.start(this.key)}))}listenToExitButtonEvents(){this.events.on("ExitButton::exit",(()=>{this.music.stop(),this.scene.start(i.StartScreen)}))}initPlayer(){var t,e;const s=this.tilemap.filterObjects(o.STAIRS_DETECTION,(t=>t.name===a.STAIRS_LINE));this.start=this.tilemap.findObject(o.PLAYER,(t=>t.name===a.START)),this.end=this.tilemap.findObject(o.PLAYER,(t=>t.name===a.END)),this.player=new p(this,(null===(t=this.start)||void 0===t?void 0:t.x)||0,(null===(e=this.start)||void 0===e?void 0:e.y)||0,s),this.player.create(),this.cameras.main.startFollow(this.player),this.cameras.main.setLerp(.1,.1),this.physics.add.collider(this.player,[this.groundLayer,this.platformsLayer]),this.stairsLayer&&this.physics.add.collider(this.player,this.stairsLayer)}createTimeTeleporters(){const t=this.tilemap.getObjectLayer(o.TIME_TELEPORTERS);if(!t)return;const e=t.objects;if(0!==e.length){for(const t of e){const e=this.utils.getPropertiesAsObject(t),{group:s,num:i}=e;switch(e.type){case"simple":{const e=new R(this,(null==t?void 0:t.x)||0,(null==t?void 0:t.y)||0,s);this.simpleTimeTeleporterGroup.add(e);break}case"double":{const e=new L(this,(null==t?void 0:t.x)||0,(null==t?void 0:t.y)||0,s,i);this.doubleTimeTeleportersGroup.add(e);const a=this.utils.findObjectOnGroup(this.doubleTimeTeleportersGroup,(t=>t.group===e.group&&t.num!==e.num));a&&(e.addOpposite(a),a.addOpposite(e));break}case"multi":{const{close:a}=e,o=new E(this,(null==t?void 0:t.x)||0,(null==t?void 0:t.y)||0,s,i,a);this.multiTimeTeleportersGroup.add(o);break}}}this.physics.add.collider([this.simpleTimeTeleporterGroup,this.doubleTimeTeleportersGroup,this.multiTimeTeleportersGroup],[this.groundLayer,this.platformsLayer]),this.initCollidersForSimpleTimeTeleporters(),this.initCollidersForDoubleTimeTeleporters(),this.utils.iterateOnGroup(this.multiTimeTeleportersGroup,(t=>{this.initMultiTimeTeleportersObjectsColliders(t.group,t.num)})),this.initMultiTimeTeleportersOpposites(),this.closeMultiTimeTeleporters(),this.listenToMultiTimeTeleportersEvents()}}initMultiTimeTeleportersOpposites(){this.utils.iterateOnGroup(this.multiTimeTeleportersGroup,(t=>{this.utils.iterateOnGroup(this.multiTimeTeleportersGroup,(e=>{e.group===t.group&&e.num!==t.num&&t.addOpposites(e)}))}))}initCollidersForDoubleTimeTeleporters(){this.utils.iterateOnGroup(this.doubleTimeTeleportersGroup,(t=>{const e=this.physics.add.collider(this.player,t,(()=>{this.utils.shakeOnTpCollision(),t.activate();const e="left"===this.player.direction?-20:20,s=new G(this,t.x-e,t.y,this.player);this.pastPlayersGroup.add(s)})),s=this.physics.add.collider(t,this.ballGroup,((t,e)=>{e.destroy()}));this.physics.add.collider(t,this.pastPlayersGroup,((t,e)=>{const s=e.body.gameObject.x,i="left"===this.player.direction?-20:20;e.body.gameObject.setX(s-i)})),t.addColliders(s,e)}))}initCollidersForSimpleTimeTeleporters(){this.utils.iterateOnGroup(this.simpleTimeTeleporterGroup,(t=>{const e=this.physics.add.collider(this.player,this.simpleTimeTeleporterGroup,((t,e)=>{this.utils.shakeOnTpCollision();const s=e;s.activate(),this.events.emit("BaseLevel::firstTp");const i="left"===this.player.direction?-20:20,a=new G(this,s.x-i,s.y,this.player);this.pastPlayersGroup.add(a)})),s=this.physics.add.collider(this.simpleTimeTeleporterGroup,this.ballGroup,((t,e)=>{e.destroy()}));this.physics.add.collider(this.simpleTimeTeleporterGroup,this.pastPlayersGroup,((t,e)=>{const s=e.body.gameObject.x,i=t.body.gameObject.x;i>s&&e.body.gameObject.setX(s-20),i<s&&e.body.gameObject.setX(s+20)})),t.addColliders(e,s)}))}createTimeSwitchers(){const t=this.tilemap.getObjectLayer(o.TIME_SWITCHERS);if(!t)return;const e=t.objects;if(0!==e.length)for(const t of e){const e=this.utils.getPropertiesAsObject(t),{group:s,num:i}=e;switch(e.type){case"simple":{const e=new C(this,(null==t?void 0:t.x)||0,(null==t?void 0:t.y)||0,s,i);this.simpleSwitcherGroup.add(e);break}case"double":{const e=new O(this,(null==t?void 0:t.x)||0,(null==t?void 0:t.y)||0,s,i);this.doubleSwitchersGroup.add(e);break}case"multi":{const e=new A(this,(null==t?void 0:t.x)||0,(null==t?void 0:t.y)||0,s,i);this.multiSwitchersGroup.add(e);break}}}}createSpatialTeleporters(){const t=this.utils.filterObjectsByLayerAndName(o.SPATIAL_TELEPORTERS,a.SPATIAL_DOOR);for(const e of t){const{num:t,group:s,sprite:i}=this.utils.getPropertiesAsObject(e),a=new D(this,(null==e?void 0:e.x)||0,(null==e?void 0:e.y)||0,i,s,t);this.spatialTeleportersGroup.add(a)}}closeMultiTimeTeleporters(){this.utils.iterateOnGroup(this.multiTimeTeleportersGroup,(t=>{t.close&&t.setToClose()}))}initMultiTimeTeleportersObjectsColliders(t,e){const s=this.utils.findObjectOnGroup(this.multiTimeTeleportersGroup,(s=>s.group===t&&s.num===e));if(!s)return;const i=this.physics.add.collider(this.player,s,((t,e)=>{if(e.alive){this.utils.shakeOnTpCollision(),e.activate();const s="left"===t.direction?-20:20,i=new G(this,e.x-s,e.y,this.player);this.pastPlayersGroup.add(i)}})),a=this.physics.add.collider(s,this.ballGroup,((t,e)=>{s.alive&&e.destroy()}));this.physics.add.collider(s,this.pastPlayersGroup,((t,e)=>{const s=e.body.gameObject.x,i="left"===this.player.direction?-20:20;e.body.gameObject.setX(s-i)})),s.addColliders(a,i)}checkForTeleportersActivation(){this.utils.iterateOnGroup(this.spatialTeleportersGroup,(t=>{this.utils.intersectObjects(this.player,t)&&this.player.enterActivate&&t.activate()})),this.utils.iterateOnGroup(this.simpleSwitcherGroup,(t=>{this.utils.intersectObjects(this.player,t)&&this.player.enterActivate&&t.activate()})),this.utils.iterateOnGroup(this.doubleSwitchersGroup,(t=>{this.utils.intersectObjects(this.player,t)&&this.player.enterActivate&&t.activate()})),this.utils.iterateOnGroup(this.multiSwitchersGroup,(t=>{this.utils.intersectObjects(this.player,t)&&this.player.enterActivate&&t.activate()}))}listenToMultiTimeTeleportersEvents(){this.events.on("MultiTimeTeleporter::setToOpen",((t,e)=>{this.initMultiTimeTeleportersObjectsColliders(t,e)}))}addDialog(t,e){const{x:s,y:i}=this.tilemap.findObject(o.DIALOGS,(e=>e.properties[0].value===t));this.dialogs.set(JSON.stringify({x:s,y:i}),e)}startDialog(t){if(!this.isDialogLaunched&&this.allowsTutorials){const e=this.cameras.main.worldView.x+25,s=this.cameras.main.worldView.y+this.cameras.main.height/2;this.textBox=new m(this,e,s),this.textBox.start(t),this.player.pause(),this.isDialogLaunched=!0}}checkForLevelEnd(){var t,e,s,i,a;if(this.player.x>((null===(t=this.end)||void 0===t?void 0:t.x)||0)-10&&this.player.x<((null===(e=this.end)||void 0===e?void 0:e.x)||0)+10&&this.player.y>((null===(s=this.end)||void 0===s?void 0:s.y)||0)-10&&this.player.y<((null===(i=this.end)||void 0===i?void 0:i.y)||0)+10&&this.player.enterActivate){const t=this.utils.findObjectOnGroup(this.pastPlayersGroup,(t=>!t.isDead));(null===(a=this.pastPlayersGroup)||void 0===a?void 0:a.getLength())>0&&t?this.time.now>this.nextActivability&&(this.nextActivability=this.time.now+this.activabilityRate,this.hasFx&&this.sound.play("door_close")):(this.hasFx&&this.sound.play("end_level"),this.music.stop(),this.scene.start(this.nextScene))}}listenToPastPlayersEvents(){this.events.on("PastPlayer::init",(()=>{this.time.delayedCall(200,(()=>{this.doorExit.close()}))}),this),this.events.on("PastPlayer::shotBullet",(t=>{this.ballGroup.add(t),this.physics.add.collider([this.groundLayer],t,(()=>{t.destroy()}))}),this),this.events.on("PastPlayer::isDead",(()=>{this.utils.findObjectOnGroup(this.pastPlayersGroup,(t=>!t.isDead))||this.time.delayedCall(200,(()=>{this.doorExit.open()}))}),this)}listenToPlayerEvents(){this.events.on("Player::shotBullet",(t=>{this.events.emit("BaseLevel::firstShotGun"),this.ballGroup.add(t),this.physics.add.collider([this.groundLayer],t,(()=>{t.destroy()}))}),this),this.events.on("Player::isDead",(()=>{this.store.set("score",0),alert(this.translate.get(i.BaseLevel,0)),location.reload()}))}listenToMyTextBoxEvents(){this.events.on("MyTextBox::complete",(()=>{this.isDialogLaunched=!1,this.time.delayedCall(500,(()=>{this.player.resume()}))}),this)}initDoors(){if(this.tilemap.findObject(o.DOORS,(t=>t.name===a.DOOR_START))){const{x:t,y:e}=this.tilemap.findObject(o.DOORS,(t=>t.name===a.DOOR_START));this.doorEntrance=new _(this,t||0,e||0)}if(this.tilemap.findObject(o.DOORS,(t=>t.name===a.DOOR_END))){const{x:t,y:e}=this.tilemap.findObject(o.DOORS,(t=>t.name===a.DOOR_END));this.doorExit=new P(this,t||0,e||0)}this.doorEntrance&&this.doorExit&&this.physics.add.collider([this.doorEntrance,this.doorExit],[this.groundLayer,this.platformsLayer])}initPastPlayers(){this.pastPlayersGroup=this.add.group(),this.pastPlayersGroup.runChildUpdate=!0,this.physics.add.collider(this.pastPlayersGroup,[this.groundLayer,this.platformsLayer])}initMap(){this.tilemap=this.add.tilemap(this.tilesetKey),this.tileset=this.tilemap.addTilesetImage("tileset","tileset"),this.bckgLayer=this.tilemap.createLayer(o.BACKGROUND,this.tileset,0,0),this.groundLayer=this.tilemap.createLayer(o.GROUND,this.tileset,0,0),this.wallLayer=this.tilemap.createLayer(o.WALL,this.tileset,0,0),this.wall2Layer=this.tilemap.createLayer(o.WALL2,this.tileset,0,0),this.desksLayer=this.tilemap.createLayer(o.DESKS,this.tileset,0,0),this.platformsLayer=this.tilemap.createLayer(o.PLATFORMS,this.tileset,0,0),this.ceilingLayer=this.tilemap.createLayer(o.CEILING,this.tileset,0,0),this.lightsLayer=this.tilemap.createLayer(o.LIGHTS,this.tileset,0,0),this.stairsLayer=this.tilemap.createLayer(o.STAIRS,this.tileset,0,0),this.stairsLayer&&this.stairsLayer.setCollisionByProperty({collides:!0}),this.groundLayer.setCollisionByProperty({collides:!0}),this.platformsLayer.setCollisionByProperty({collides:!0}),this.cameras.main.setBounds(0,0,this.tilemap.widthInPixels,this.tilemap.heightInPixels),this.physics.world.setBounds(0,0,this.tilemap.widthInPixels,this.tilemap.heightInPixels),this.utils.init(this.tilemap)}checkForTutorials(){this.allowsTutorials&&this.dialogs.forEach(((t,e)=>{const{x:s,y:i}=JSON.parse(e);this.isDialogLaunched||this.player.x>(s||0)-10&&this.player.x<(s||0)+10&&this.player.y>(i||0)-10&&this.player.y<(i||0)+10&&(this.startDialog(t),this.dialogs.delete(e))}))}launchMusic(){this.music=this.sound.add("levels"),this.hasMusic&&!this.music.isPlaying&&(this.musicHasBeenPlayed=!0,this.music.play({loop:!0,volume:.1}))}initAllowsTutorialsOption(){const t=this.store.get("tutorials");null!==t&&(this.allowsTutorials=t),null===t&&(this.allowsTutorials=!0)}listenToTutorialsSwitcherEvents(){this.events.on("TutorialsSwitcher::tutorials",(t=>{this.allowsTutorials=t}))}}const K={type:Phaser.AUTO,backgroundColor:"#000",antialias:!1,scale:{parent:"phaser-game",mode:Phaser.Scale.NONE,autoCenter:Phaser.Scale.CENTER_BOTH,width:700,height:480},scene:[n,class extends w{constructor(){super(i.PreloadTutorials,i.Tutorials,"tutorials")}preload(){super.preload()}create(){super.create()}},f,class extends N{constructor(){super(i.Tutorials,i.StartScreen,"tutorials"),this.endTutorialsMessagePlayed=!1}create(){super.create(),this.addDialog(0,this.translate.get(i.Tutorials,0)),this.addDialog(1,this.translate.get(i.Tutorials,1)),this.addDialog(2,this.translate.get(i.Tutorials,2)),this.addDialog(3,this.translate.get(i.Tutorials,3)),this.addDialog(4,this.translate.get(i.Tutorials,4)),this.addDialog(5,this.translate.get(i.Tutorials,5)),this.addDialog(6,this.translate.get(i.Tutorials,6)),this.addDialog(7,this.translate.get(i.Tutorials,7))}update(t,e){super.update(t,e);const s=this.tilemap.findObject(o.EVENTS,(t=>"end_tutorials"===t.name));!this.endTutorialsMessagePlayed&&s&&this.utils.coordinatesAreNear(s,this.player)&&(this.endTutorialsMessagePlayed=!0,this.player.pause(),alert(this.translate.get(i.Tutorials,8)),this.time.delayedCall(500,(()=>{this.player.resume()})))}}],physics:{default:"arcade",arcade:{debug:!0,gravity:{y:500}}},plugins:{scene:[{key:"rexUI",plugin:r.Z,mapping:"rexUI"},{key:"store",plugin:b,mapping:"store"},{key:"translate",plugin:S,mapping:"translate"},{key:"utils",plugin:T,mapping:"utils"}]}};window.addEventListener("load",(()=>{new Phaser.Game(K)}))},204:()=>{console.log("%c %c %c %c %c Built using phaser-project-template %c https://github.com/yandeu/phaser-project-template","background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none")}},s={};function i(t){var a=s[t];if(void 0!==a)return a.exports;var o=s[t]={exports:{}};return e[t].call(o.exports,o,o.exports,i),o.exports}i.m=e,t=[],i.O=(e,s,a,o)=>{if(!s){var r=1/0;for(c=0;c<t.length;c++){for(var[s,a,o]=t[c],n=!0,h=0;h<s.length;h++)(!1&o||r>=o)&&Object.keys(i.O).every((t=>i.O[t](s[h])))?s.splice(h--,1):(n=!1,o<r&&(r=o));if(n){t.splice(c--,1);var l=a();void 0!==l&&(e=l)}}return e}o=o||0;for(var c=t.length;c>0&&t[c-1][2]>o;c--)t[c]=t[c-1];t[c]=[s,a,o]},i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={179:0};i.O.j=e=>0===t[e];var e=(e,s)=>{var a,o,[r,n,h]=s,l=0;if(r.some((e=>0!==t[e]))){for(a in n)i.o(n,a)&&(i.m[a]=n[a]);if(h)var c=h(i)}for(e&&e(s);l<r.length;l++)o=r[l],i.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return i.O(c)},s=self.webpackChunkparadoxe=self.webpackChunkparadoxe||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))})(),i.O(void 0,[216],(()=>i(175)));var a=i.O(void 0,[216],(()=>i(204)));a=i.O(a)})();