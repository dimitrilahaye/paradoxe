/*! For license information please see main.a4f5364b6fa660a4ca5c.bundle.js.LICENSE.txt */
(()=>{var e,t={653:(e,t,s)=>{"use strict";s(260);var i,r,a,o=s(227);class n extends Phaser.Scene{constructor(e,t,s){super({key:e}),this.nextScene=t,this.tilesetKey=s,this.key=e}preload(){this.load.scenePlugin({key:"rexUI",sceneKey:"rexUI"}),this.load.image("nextPage","assets/img/ui/arrow-down-left.png"),this.load.image("dialogEnd","assets/img/ui/cancel.png"),this.load.audio("death","assets/sounds/death.wav"),this.load.audio("door_tp","assets/sounds/door_tp.wav"),this.load.audio("simple_gun_shot","assets/sounds/simple_gun_shot.wav"),this.load.audio("levels","assets/sounds/levels.wav"),this.load.audio("tp","assets/sounds/tp.wav"),this.load.audio("walk","assets/sounds/walk.wav"),this.load.audio("switcher","assets/sounds/switcher.wav"),this.load.audio("door_open","assets/sounds/door_open.wav"),this.load.audio("door_close","assets/sounds/door_close.wav"),this.load.audio("end_level","assets/sounds/end_level.wav"),this.load.image("tileset","assets/img/tileset.png"),this.load.image("door_start","assets/img/objects/door_start.png"),this.load.image("door_end_open","assets/img/objects/door_end_open.png"),this.load.image("door_end_close","assets/img/objects/door_end_close.png"),this.load.image("door_tp","assets/img/objects/door_tp.png"),this.load.image("door_tp_red","assets/img/objects/door_tp_red.png"),this.load.image("door_tp_green","assets/img/objects/door_tp_green.png"),this.load.image("tp_red","assets/img/objects/tp_red.png"),this.load.image("tp_red_close","assets/img/objects/tp_red_close.png"),this.load.image("tp_orange","assets/img/objects/tp_orange.png"),this.load.image("tp_orange_close","assets/img/objects/tp_orange_close.png"),this.load.image("tp_green","assets/img/objects/tp_green.png"),this.load.image("tp_green_close","assets/img/objects/tp_green_close.png"),this.load.image("switcher_red","assets/img/objects/switcher_red.png"),this.load.image("switcher_green","assets/img/objects/switcher_green.png"),this.load.image("switcher_orange","assets/img/objects/switcher_orange.png"),this.load.image("reset","assets/img/ui/return.png"),this.load.image("exit","assets/img/ui/exit.png"),this.load.image("audio_on","assets/img/ui/audioOn.png"),this.load.image("audio_off","assets/img/ui/audioOff.png"),this.load.image("music_on","assets/img/ui/musicOn.png"),this.load.image("music_off","assets/img/ui/musicOff.png"),this.load.tilemapTiledJSON(this.tilesetKey,`assets/json/levels/${this.tilesetKey}.json`),this.load.atlas("player","assets/img/chars/player_atlas.png","assets/json/chars/player_atlas.json"),this.load.atlas("simple_bullet","assets/img/objects/simple_bullet_atlas.png","assets/json/objects/simple_bullet_atlas.json"),this.load.atlas("simple_gun_shot","assets/img/particles/simple_gun_shot.png","assets/json/particles/simple_gun_shot.json")}create(){this.store.set("level",this.key),this.scene.start(this.nextScene)}}!function(e){e.PreloadStartScreen="PreloadStartScreen",e.StartScreen="StartScreen",e.PreloadLevel1="PreloadLevel1",e.Level1="Level1",e.PreloadLevel2="PreloadLevel2",e.Level2="Level2",e.PreloadLevel3="PreloadLevel3",e.Level3="Level3",e.PreloadLevel4="PreloadLevel4",e.Level4="Level4",e.PreloadLevel5="PreloadLevel5",e.Level5="Level5",e.PreloadLevel6="PreloadLevel6",e.Level6="Level6",e.PreloadLevel7="PreloadLevel7",e.Level7="Level7"}(i||(i={})),function(e){e.DOOR_START="start",e.DOOR_END="end",e.START="start",e.END="end",e.DIALOG="dialog",e.DOOR_TP_GREEN_1="door_tp_green_1",e.DOOR_TP_GREEN_2="door_tp_green_2",e.DOOR_TP_RED_1="door_tp_red_1",e.DOOR_TP_RED_2="door_tp_red_2",e.TP_SIMPLE="tp_simple",e.TP_DOUBLE_1="tp_double_1",e.TP_DOUBLE_2="tp_double_2",e.TP_MULTI_1="tp_multi_1",e.TP_MULTI_2="tp_multi_2",e.TP_MULTI_3="tp_multi_3",e.SWITCHER_SIMPLE="switcher_simple",e.SWITCHER_DOUBLE="switcher_double",e.SWITCHER_MULTI_1="switcher_multi_1",e.SWITCHER_MULTI_2="switcher_multi_2",e.SWITCHER_MULTI_3="switcher_multi_3"}(r||(r={})),function(e){e.DIALOGS="dialogs",e.TELEPORTERS_SPATIAL="teleporters_spatial",e.PLAYER="player",e.DOORS="doors",e.TELEPORTERS_MULTI="teleporters_multi",e.SWITCHERS_MULTI="switchers_multi",e.TELEPORTERS_SIMPLE="teleporters_simple",e.SWITCHERS_SIMPLE="switchers_simple",e.TELEPORTERS_DOUBLE="teleporters_double",e.SWITCHERS_DOUBLE="switchers_double",e.CEILING="ceiling",e.LIGHTS="lights",e.OPTIONS="options",e.PLATFORMS="platforms",e.DESKS="desks",e.WALL2="wall2",e.WALL="wall",e.TP="tp",e.GROUND="ground",e.BACKGROUND="background",e.TITLE="title"}(a||(a={}));class l extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s){super(e,t,s,"door_start"),e.add.existing(this)}}class h extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s){var i;super(e,t,s,"door_end_open"),e.add.existing(this),this.hasFx=null===(i=this.scene.store.get("fx"))||void 0===i||i,this.create()}create(){this.scene.events.on("Store::fx",(e=>{this.hasFx=e}))}open(){this.setTexture("door_end_open"),this.hasFx&&this.scene.sound.play("door_open")}close(){this.setTexture("door_end_close"),this.hasFx&&this.scene.sound.play("door_close")}}class c extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s){var i;super(e,t,s,"switcher_red"),this.nextActivability=0,this.activabilityRate=500,e.add.existing(this),this.hasFx=null===(i=this.scene.store.get("fx"))||void 0===i||i,this.create()}create(){this.scene.events.on("Store::fx",(e=>{this.hasFx=e}))}activate(){this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.hasFx&&this.scene.sound.play("switcher"),this.scene.events.emit("DoubleSwitcher::activate"))}}class d extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s){var i;super(e,t,s,"tp_red"),this.collidersGroup=[],this.alive=!0,e.add.existing(this),this.scene.physics.world.enable(this),this.setImmovable(!0),this.hasFx=null===(i=this.scene.store.get("fx"))||void 0===i||i,this.create()}create(){this.scene.events.on("DoubleSwitcher::activate",(()=>{this.alive&&(this.alive=!1,this.setTexture("tp_red_close"),this.collidersGroup.forEach((e=>this.scene.physics.world.removeCollider(e))))})),this.scene.events.on("Store::fx",(e=>{this.hasFx=e}))}addColliders(...e){this.collidersGroup.push(...e)}addOpposite(e){this.oppositeDoubleTimeTeleporter=e}activate(){this.hasFx&&this.scene.sound.play("tp"),this.scene.events.emit("DoubleTimeTeleporter::activate",{x:this.x,y:this.y},this.getOppositeCoordinates())}getOppositeCoordinates(){const{x:e,y:t}=this.oppositeDoubleTimeTeleporter;return{x:e,y:t}}}class p extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s,i,r){super(e,t,s,i),this._nextTp=0,this._tpRate=500,e.add.existing(this),this.num=r}get nextTp(){return this._nextTp}set nextTp(e){this._nextTp=e}get tpRate(){return this._tpRate}}class u extends p{constructor(e,t,s,i){var r;super(e,t,s,"door_tp_green",i),this.hasFx=null===(r=this.scene.store.get("fx"))||void 0===r||r,this.create()}create(){this.scene.events.on("GreenSpatialTeleporter::activate",((e,t)=>{this.num===e&&(this.nextTp=t,this.scene.events.emit("SpatialTeleporter::teleport",{x:this.x,y:this.y}))})),this.scene.events.on("Store::fx",(e=>{this.hasFx=e}))}activate(){if(this.scene.time.now>this.nextTp){this.nextTp=this.scene.time.now+this.tpRate;const e=0===this.num?1:0;this.hasFx&&this.scene.sound.play("door_tp"),this.scene.events.emit("GreenSpatialTeleporter::activate",e,this.nextTp)}}}class m extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s,i){var r;super(e,t,s,"switcher_orange"),this.nextActivability=0,this.activabilityRate=500,e.add.existing(this),this.num=i,this.hasFx=null===(r=this.scene.store.get("fx"))||void 0===r||r,this.create()}create(){this.scene.events.on("Store::fx",(e=>{this.hasFx=e}))}activate(){this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.hasFx&&this.scene.sound.play("switcher"),this.scene.events.emit("MultiSwitcher::activate",this.num))}}class y extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s,i){var r;super(e,t,s,"tp_orange"),this.collidersGroup=[],this.oppositeMultiTimeTeleporters=[],this._alive=!0,e.add.existing(this),this.scene.physics.world.enable(this),this.setImmovable(!0),this.num=i,this.hasFx=null===(r=this.scene.store.get("fx"))||void 0===r||r,this.create()}get alive(){return this._alive}set alive(e){this._alive=e}get num(){return this._num}set num(e){this._num=e}create(){this.scene.events.on("MultiSwitcher::activate",(e=>{if(e===this.num){const e=this.oppositeMultiTimeTeleporters.find((e=>e.alive)),t=this.oppositeMultiTimeTeleporters.find((e=>!e.alive));e&&e.setToClose(),this.alive?t&&t.setToOpen():this.setToOpen();const s=this.oppositeMultiTimeTeleporters.shift();this.oppositeMultiTimeTeleporters.push(s)}})),this.scene.events.on("Store::fx",(e=>{this.hasFx=e}))}setToOpen(){this.alive=!0,this.setTexture("tp_orange"),this.scene.events.emit("MultiTimeTeleporter::setToOpen",this.num)}setToClose(){this.alive=!1,this.setTexture("tp_orange_close"),this.collidersGroup.filter((e=>e.active)).forEach((e=>e.destroy()))}addColliders(...e){this.collidersGroup.push(...e)}addOpposites(...e){this.oppositeMultiTimeTeleporters.push(...e)}activate(){this.hasFx&&this.scene.sound.play("tp"),this.scene.events.emit("DoubleTimeTeleporter::activate",{x:this.x,y:this.y},this.getOppositeCoordinates())}getOppositeCoordinates(){const e=this.oppositeMultiTimeTeleporters.find((e=>e.alive))||this.oppositeMultiTimeTeleporters[0],{x:t,y:s}=e;return{x:t,y:s}}}class v extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s){var i;super(e,t,s,"player","idle-1"),this.isDead=!1,this.isDeadEventEmitted=!1,this.hasFx=!0,e.add.existing(this),this.scene.physics.world.enable(this),this.setCollideWorldBounds(!0),this.hasFx=null===(i=this.scene.store.get("fx"))||void 0===i||i}create(){this.init(),this.scene.events.emit("PastPlayer::init"),this.anims.create({key:"walk",frames:this.scene.anims.generateFrameNames("player",{prefix:"walk-",start:1,end:6}),frameRate:5,repeat:-1}),this.anims.create({key:"death",frames:this.scene.anims.generateFrameNames("player",{prefix:"death-",start:1,end:5}),frameRate:5,repeat:0}),this.anims.create({key:"shot",frames:this.scene.anims.generateFrameNames("player",{prefix:"shot-",start:1,end:3}),frameRate:5,repeat:-1}),this.scene.events.on("Player::shotBullet",((e,t)=>{this.scene.physics.add.collider(this,e,(()=>{e.destroy(),this.isDead||(this.flipX="left"!==t,this.isDead=!0,this.body.enable=!1,this.hasFx&&this.scene.sound.play("death"),this.anims.play("death",!0),this.setVelocity(0))}),void 0,this)}),this),this.scene.events.on("Store::fx",(e=>{this.hasFx=e}))}update(){this.on("animationcomplete",(()=>{this.isDead&&!this.isDeadEventEmitted&&(this.anims.stop(),this.scene.events.emit("PastPlayer::isDead"),this.isDeadEventEmitted=!0)}))}init(){this.speedX=180,this.speedY=180,this.body.setSize(2)}}class g extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s){var i;super(e,t,s,"player","idle-1"),this.isMovable=!0,this.speedX=180,this.nextFire=0,this.fireRate=500,this.nextWalkSound=0,this.walkSoundRate=500,this.nextActivability=0,this.activabilityRate=500,this.hasFx=!0,e.add.existing(this),this.scene.physics.world.enable(this),this.setCollideWorldBounds(!0),this.hasFx=null===(i=this.scene.store.get("fx"))||void 0===i||i}create(){this.initCharacs(),this.initKeyboardInputs(),this.listenToSpatialTeleporterEvents(),this.listenToDoubleTimeTeleporterEvents(),this.listenToSimpleTimeTeleporterEvents(),this.initAnimations(),this.initBulletsGroups(),this.listenToStoreEvents()}update(){this.movePlayer(),this.checkActions()}pause(){this.isMovable=!1}resume(){this.isMovable=!0}listenToStoreEvents(){this.scene.events.on("Store::fx",(e=>{this.hasFx=e}))}initBulletsGroups(){this.bullets=this.scene.physics.add.group({defaultKey:"simple_bullet",allowGravity:!1,immovable:!0,frameQuantity:5})}initAnimations(){this.anims.create({key:"walk",frames:this.scene.anims.generateFrameNames("player",{prefix:"walk-",start:1,end:6}),frameRate:5,repeat:-1}),this.anims.create({key:"death",frames:this.scene.anims.generateFrameNames("player",{prefix:"death-",start:1,end:5}),frameRate:5,repeat:-1}),this.anims.create({key:"shot",frames:this.scene.anims.generateFrameNames("player",{prefix:"shot-",start:1,end:3}),frameRate:5,repeat:-1}),this.anims.create({key:"simple_gun_shot",frames:this.scene.anims.generateFrameNames("simple_gun_shot",{prefix:"hits-1-",start:2,end:5}),frameRate:5,repeat:0}),this.scene.anims.create({key:"simple_bullet",frames:this.scene.anims.generateFrameNames("simple_bullet",{prefix:"simple-bullet-",start:1,end:4}),frameRate:5,repeat:-1})}listenToSimpleTimeTeleporterEvents(){this.scene.events.on("SimpleTimeTeleporter::activate",(({x:e,y:t})=>{this.teleportOnCoordinates({x:e,y:t})}))}listenToDoubleTimeTeleporterEvents(){this.scene.events.on("DoubleTimeTeleporter::activate",((e,{x:t,y:s})=>{this.teleportOnCoordinates({x:t,y:s})}))}listenToSpatialTeleporterEvents(){this.scene.events.on("SpatialTeleporter::teleport",(({x:e,y:t})=>{this.teleportOnCoordinates({x:e,y:t})}))}teleportOnCoordinates({x:e,y:t}){const s="left"===this.direction?e-10:e+10;this.setPosition(s,t)}checkActions(){this.isMovable?(this.enter.isDown?this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.enterActivate=!0):this.enterActivate=!1,this.shot.isDown?this.isShooting=!0:this.isShooting=!1,this.isShooting&&(this.anims.play("shot"),this.scene.time.now>this.nextFire&&(this.nextFire=this.scene.time.now+this.fireRate,"left"===this.direction&&this.shotBullet(-500),"right"===this.direction&&this.shotBullet(500)))):(this.enterActivate=!1,this.isShooting=!1)}shotBullet(e){this.hasFx&&this.scene.sound.play("simple_gun_shot",{volume:1});const t="left"===this.direction?this.x-12:this.x+12,s=this.scene.add.sprite(t,this.y,"simple_gun_shot");this.anims.play("simple_gun_shot"),this.scene.time.delayedCall(50,(()=>{this.anims.stop(),s.destroy()}));const i=this.bullets.get(this.x,this.y);i.anims.play("simple_bullet"),i.body.velocity.x=e,i.checkWorldBounds=!0,i.outOfBoundsKill=!0,this.scene.events.emit("Player::shotBullet",i,this.direction)}initCharacs(){this.body.setSize(2),this.direction="right"}initKeyboardInputs(){this.left=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.LEFT),this.right=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.RIGHT),this.enter=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.ENTER),this.shot=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE)}movePlayer(){this.isMovable?(this.left.isDown?this.goLeft=!0:this.goLeft=!1,this.right.isDown?this.goRight=!0:this.goRight=!1,this.isShooting?this.setVelocityX(0):(this.goLeft||this.goRight?(this.anims.play("walk",!0),this.scene.time.now>this.nextWalkSound&&(this.nextWalkSound=this.scene.time.now+this.walkSoundRate,this.hasFx&&this.scene.sound.play("walk"))):(this.anims.stop(),this.setTexture("player","idle-1")),this.goLeft?(this.flipX=!0,this.setVelocityX(-this.speedX),this.direction="left"):this.goRight?(this.flipX=!1,this.setVelocityX(this.speedX),this.direction="right"):this.setVelocityX(0))):(this.setVelocityX(0),this.anims.stop(),this.setTexture("player","idle-1"))}}class T extends p{constructor(e,t,s,i){var r;super(e,t,s,"door_tp_red",i),this.hasFx=null===(r=this.scene.store.get("fx"))||void 0===r||r,this.create()}create(){this.scene.events.on("RedSpatialTeleporter::activate",((e,t)=>{this.num===e&&(this.nextTp=t,this.scene.events.emit("SpatialTeleporter::teleport",{x:this.x,y:this.y}))})),this.scene.events.on("Store::fx",(e=>{this.hasFx=e}))}activate(){if(this.scene.time.now>this.nextTp){this.nextTp=this.scene.time.now+this.tpRate;const e=0===this.num?1:0;this.hasFx&&this.scene.sound.play("door_tp"),this.scene.events.emit("RedSpatialTeleporter::activate",e,this.nextTp)}}}class x extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s){var i;super(e,t,s,"switcher_green"),this.nextActivability=0,this.activabilityRate=500,e.add.existing(this),this.hasFx=null===(i=this.scene.store.get("fx"))||void 0===i||i,this.create()}create(){this.scene.events.on("Store::fx",(e=>{this.hasFx=e}))}activate(){this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.hasFx&&this.scene.sound.play("switcher"),this.scene.events.emit("SimpleSwitcher::activate"))}}class S extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s){var i;super(e,t,s,"tp_green"),this.collidersGroup=[],this.alive=!0,e.add.existing(this),this.scene.physics.world.enable(this),this.setImmovable(!0),this.hasFx=null===(i=this.scene.store.get("fx"))||void 0===i||i,this.create()}create(){this.scene.events.on("SimpleSwitcher::activate",(()=>{this.alive&&(this.alive=!1,this.setTexture("tp_green_close"),this.collidersGroup.forEach((e=>this.scene.physics.world.removeCollider(e))))})),this.scene.events.on("Store::fx",(e=>{this.hasFx=e}))}addColliders(...e){this.collidersGroup.push(...e)}activate(){this.hasFx&&this.scene.sound.play("tp"),this.scene.events.emit("SimpleTimeTeleporter::activate",{x:this.x,y:this.y})}}class b extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s){super(e,t,s,"exit"),this.nextActivability=0,this.activabilityRate=500,e.add.existing(this),this.setInteractive(),this.setScale(.5),this.create()}create(){this.on("pointerdown",(()=>{this.activate()})),this.on("pointerover",(()=>{this.scene.sys.canvas.style.cursor="pointer"})),this.on("pointerout",(()=>{this.scene.sys.canvas.style.cursor="default"}))}activate(){this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.scene.events.emit("ExitButton::exit"))}}class w extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s){const i=e.store.get("fx");super(e,t,s,i?"audio_on":"audio_off"),this.nextActivability=0,this.activabilityRate=500,e.add.existing(this),this.setInteractive(),this.setScale(.5),this.create()}create(){this.on("pointerdown",(()=>{this.activate()})),this.on("pointerover",(()=>{this.scene.sys.canvas.style.cursor="pointer"})),this.on("pointerout",(()=>{this.scene.sys.canvas.style.cursor="default"}))}activate(){if(this.scene.time.now>this.nextActivability){this.nextActivability=this.scene.time.now+this.activabilityRate;const e=this.scene.store.get("fx");this.scene.store.set("fx",!e),e||this.setTexture("audio_on"),e&&this.setTexture("audio_off")}}}class _ extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s){const i=e.store.get("music");super(e,t,s,i?"music_on":"music_off"),this.nextActivability=0,this.activabilityRate=500,e.add.existing(this),this.setInteractive(),this.setScale(.5),this.create()}create(){this.on("pointerdown",(()=>{this.activate()})),this.on("pointerover",(()=>{this.scene.sys.canvas.style.cursor="pointer"})),this.on("pointerout",(()=>{this.scene.sys.canvas.style.cursor="default"}))}activate(){if(this.scene.time.now>this.nextActivability){this.nextActivability=this.scene.time.now+this.activabilityRate;const e=this.scene.store.get("music");this.scene.store.set("music",!e),e||this.setTexture("music_on"),e&&this.setTexture("music_off")}}}class f{constructor(e,t,s){this.scene=e,this.x=t,this.y=s}get box(){return this.textBox}start(e){const t=1199753;this.textBox=this.scene.rexUI.add.textBox({x:this.x-18,y:this.y-60,background:this.createSpeechBubbleShape(this.scene,16777215,t),icon:this.scene.rexUI.add.roundRectangle(0,0,2,2,20,t),text:this.getBBcodeText(this.scene,500,500,500,100),action:this.scene.add.image(0,0,"nextPage").setTint(t).setVisible(!1),space:{left:20,right:20,top:20,bottom:20,icon:10,text:10}}).setOrigin(0).layout();const s=this.textBox;this.scene.input.keyboard.on("keydown-ENTER",(()=>{this.textBox.isTyping?this.textBox.stop(!0):this.textBox.isLastPage?this.destroy():this.textBox.typeNextPage()})),this.scene.input.keyboard.on("keydown-ESC",(()=>{this.destroy()})),this.textBox.setInteractive().on("pageend",(()=>{const e=s.getElement("action");s.isLastPage&&e.setTexture("dialogEnd").setTint(t),e.setVisible(!0),s.resetChildVisibleState(e),e.y-=30,this.scene.tweens.add({targets:e,y:"+=30",ease:"Bounce",duration:500,repeat:0,yoyo:!1})})),this.textBox.start(e,50)}destroy(){this.scene.input.keyboard.off("keydown-ENTER"),this.scene.input.keyboard.off("keydown-ESC"),this.textBox.destroy(),this.scene.events.emit("MyTextBox::complete")}getBBcodeText(e,t,s,i,r){return e.rexUI.add.BBCodeText(0,0,"",{fixedWidth:i,fixedHeight:r,color:0,fontSize:"20px",wrap:{mode:"word",width:t,height:s},maxLines:4})}createSpeechBubbleShape(e,t,s){return e.rexUI.add.customShapes({create:{lines:1},update:function(){const e=20,i=this.width,r=this.height,a=r-15;this.getShapes()[0].lineStyle(2,s,1).fillStyle(t,1).startAt(20,0).lineTo(i-e,0).arc(i-e,20,e,270,360).lineTo(i,a-e).arc(i-e,a-e,e,0,90).lineTo(60,a).lineTo(50,r).lineTo(40,a).lineTo(20,a).arc(20,a-e,e,90,180).lineTo(0,20).arc(20,20,e,180,270).close()}})}}class O extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s){super(e,t,s,"reset"),this.nextActivability=0,this.activabilityRate=500,e.add.existing(this),this.setInteractive(),this.setScale(.5),this.create()}create(){this.on("pointerdown",(()=>{this.activate()})),this.on("pointerover",(()=>{this.scene.sys.canvas.style.cursor="pointer"})),this.on("pointerout",(()=>{this.scene.sys.canvas.style.cursor="default"}))}activate(){this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.scene.events.emit("ResetButton::reset"))}}class L extends Phaser.Scene{constructor(e,t,s){super({key:e}),this.nextScene=t,this.tilesetKey=s,this.dialogs=new Map,this.isDialogLaunched=!1,this.key=e}create(){var e,t;this.hasFx=null===(e=this.store.get("fx"))||void 0===e||e,this.hasMusic=null===(t=this.store.get("music"))||void 0===t||t,this.ballGroup=this.add.group(),this.spatialTeleportersGroup=this.add.group(),this.simpleTimeTeleporterGroup=this.add.group(),this.simpleSwitcherGroup=this.add.group(),this.doubleTimeTeleportersGroup=this.add.group(),this.doubleSwitchersGroup=this.add.group(),this.multiTimeTeleportersGroup=this.add.group(),this.multiSwitchersGroup=this.add.group(),this.initMap(),this.initDoors(),this.initPastPlayers(),new b(this,30,60),new O(this,80,60),new _(this,130,60),new w(this,180,60),this.listenToPlayerEvents(),this.listenToPastPlayersEvents(),this.listenToMyTextBoxEvents(),this.listenToMultiTimeTeleportersEvents(),this.launchMusic(),this.initAllowsTutorialsOption(),this.listenToTutorialsSwitcherEvents(),this.listenToResetButtonEvents(),this.listenToExitButtonEvents(),this.listenToFxButtonEvents(),this.listenToMusicButtonEvents()}update(){this.player.update(),this.iterateOnPastPlayers((e=>e.update())),this.checkForTutorials(),this.checkForLevelEnd()}listenToMusicButtonEvents(){this.events.on("Store::music",(e=>{this.hasMusic=e,e||this.music.pause(),e&&(this.musicHasBeenPlayed&&this.music.resume(),this.musicHasBeenPlayed||this.launchMusic())}))}listenToFxButtonEvents(){this.events.on("Store::fx",(e=>{this.hasFx=e}))}listenToResetButtonEvents(){this.events.on("ResetButton::reset",(()=>{this.music.stop(),this.scene.start(this.key)}))}listenToExitButtonEvents(){this.events.on("ExitButton::exit",(()=>{this.music.stop(),this.scene.start(i.PreloadStartScreen)}))}initPlayer(){var e,t;this.start=this.tilemap.findObject(a.DOORS,(e=>e.name===r.START)),this.end=this.tilemap.findObject(a.DOORS,(e=>e.name===r.END)),this.player=new g(this,(null===(e=this.start)||void 0===e?void 0:e.x)||0,(null===(t=this.start)||void 0===t?void 0:t.y)||0),this.player.create(),this.cameras.main.startFollow(this.player),this.physics.add.collider(this.player,[this.groundLayer,this.platformsLayer])}createSimpleTimeTeleporter(){const e=this.getObjectByLayerAndProperties(a.TELEPORTERS_SIMPLE,{num:0});if(e){const t=new S(this,(null==e?void 0:e.x)||0,(null==e?void 0:e.y)||0);t.setData("num",0),this.simpleTimeTeleporterGroup.add(t)}}createSimpleSwitcher(){const e=this.getObjectByLayerAndProperties(a.SWITCHERS_SIMPLE,{num:0});if(e){const t=new x(this,(null==e?void 0:e.x)||0,(null==e?void 0:e.y)||0);t.setData("num",0),this.simpleSwitcherGroup.add(t)}}createDoubleTimeTeleporters(){const e=this.getObjectByLayerAndProperties(a.TELEPORTERS_DOUBLE,{num:0}),t=this.getObjectByLayerAndProperties(a.TELEPORTERS_DOUBLE,{num:1});if(e&&t){const s=new d(this,(null==e?void 0:e.x)||0,(null==e?void 0:e.y)||0),i=new d(this,(null==t?void 0:t.x)||0,(null==t?void 0:t.y)||0);s.addOpposite(i),i.addOpposite(s),this.doubleTimeTeleportersGroup.add(s),this.doubleTimeTeleportersGroup.add(i)}}createDoubleSwitcher(){const e=this.getObjectByLayerAndProperties(a.SWITCHERS_DOUBLE,{num:0});if(e){const t=new c(this,(null==e?void 0:e.x)||0,(null==e?void 0:e.y)||0);this.doubleSwitchersGroup.add(t)}}createMultiTimeTeleporterByNum(e){const t=this.getObjectByLayerAndProperties(a.TELEPORTERS_MULTI,{num:e});if(t){const s=this.getPropertiesAsObject(t),i=new y(this,(null==t?void 0:t.x)||0,(null==t?void 0:t.y)||0,e);i.setData("num",e),i.setData("close",s.close),this.multiTimeTeleportersGroup.add(i)}}createMultiSwitcherByNum(e){const t=this.getObjectByLayerAndProperties(a.SWITCHERS_MULTI,{num:e});if(t){const s=new m(this,(null==t?void 0:t.x)||0,(null==t?void 0:t.y)||0,e);this.multiSwitchersGroup.add(s)}}createSpatialTeleportersByColorAndNum(e,t){const s=this.getObjectByLayerAndProperties(a.TELEPORTERS_SPATIAL,{color:e,num:t});if(s)if("green"===e){const e=new u(this,(null==s?void 0:s.x)||0,(null==s?void 0:s.y)||0,t);this.spatialTeleportersGroup.add(e)}else if("red"===e){const e=new T(this,(null==s?void 0:s.x)||0,(null==s?void 0:s.y)||0,t);this.spatialTeleportersGroup.add(e)}}initSimpleTimeTeleporterWorldColliders(){this.physics.add.collider(this.simpleTimeTeleporterGroup,[this.groundLayer,this.platformsLayer])}initDoubleTimeTeleportersWorldColliders(){this.physics.add.collider(this.doubleTimeTeleportersGroup,[this.groundLayer,this.platformsLayer])}initMultiTimeTeleportersWorldColliders(){this.physics.add.collider(this.multiTimeTeleportersGroup,[this.groundLayer,this.platformsLayer])}closeMultiTimeTeleporters(){this.iterateOnGroup(this.multiTimeTeleportersGroup,(e=>{e.getData("close")&&e.setToClose()}))}initSimpleTimeTeleporterObjectsColliders(){const e=this.findObjectOnGroupByData(this.simpleTimeTeleporterGroup,{num:0});if(e){const t=this.physics.add.collider(this.player,this.simpleTimeTeleporterGroup,((e,t)=>{this.shakeOnTpCollision();const s=t;s.activate(),this.events.emit("BaseLevel::firstTp");const i="left"===this.player.direction?-20:20,r=new v(this,s.x-i,s.y);r.create(),this.pastPlayersGroup.add(r)})),s=this.physics.add.collider(this.simpleTimeTeleporterGroup,this.ballGroup,((e,t)=>{t.destroy()}));e.addColliders(t,s)}}initMultiTimeTeleportersObjectsCollidersByNum(e){const t=this.findObjectOnGroupByData(this.multiTimeTeleportersGroup,{num:e});if(t){const e=this.physics.add.collider(this.player,t,((e,t)=>{this.shakeOnTpCollision(),t.activate();const s="left"===e.direction?-20:20,i=new v(this,t.x-s,t.y);i.create(),this.pastPlayersGroup.add(i)})),s=this.physics.add.collider(t,this.ballGroup,((e,t)=>{t.destroy()}));t.addColliders(s,e)}}initMultiTimeTeleportersOpposites(){const e=this.multiTimeTeleportersGroup.getLength(),t=Array.from(Array(e).keys());this.iterateOnGroup(this.multiTimeTeleportersGroup,(e=>{t.forEach((t=>{if(t!==e.num){const s=this.findObjectOnGroupByData(this.multiTimeTeleportersGroup,{num:t});if(!s)throw new Error(`Unfound MultiTimeTeleporterwith num: ${t}`);e.addOpposites(s)}}))}))}initDoubleTimeTeleportersObjectsColliders(){this.iterateOnGroup(this.doubleTimeTeleportersGroup,(e=>{const t=this.physics.add.collider(this.player,e,(()=>{this.shakeOnTpCollision(),e.activate();const t="left"===this.player.direction?-20:20,s=new v(this,e.x-t,e.y);s.create(),this.pastPlayersGroup.add(s)})),s=this.physics.add.collider(e,this.ballGroup,((e,t)=>{t.destroy()}));e.addColliders(s,t)}))}checkForSpatialTeleportersActivation(){this.iterateOnGroup(this.spatialTeleportersGroup,(e=>{this.intersect(this.player,e)&&this.player.enterActivate&&e.activate()}))}checkForSimpleSwitcherActivation(){this.iterateOnGroup(this.simpleSwitcherGroup,(e=>{this.intersect(this.player,e)&&this.player.enterActivate&&e.activate()}))}checkForDoubleSwitcherActivation(){this.iterateOnGroup(this.doubleSwitchersGroup,(e=>{this.intersect(this.player,e)&&this.player.enterActivate&&e.activate()}))}checkForMultiSwitchersActivation(){this.iterateOnGroup(this.multiSwitchersGroup,(e=>{this.intersect(this.player,e)&&this.player.enterActivate&&e.activate()}))}listenToMultiTimeTeleportersEvents(){this.events.on("MultiTimeTeleporter::setToOpen",(e=>{this.initMultiTimeTeleportersObjectsCollidersByNum(e)}))}addDialog(e,t){const{x:s,y:i}=this.tilemap.findObject("dialogs",(t=>t.properties[0].value===e));this.dialogs.set(JSON.stringify({x:s,y:i}),t)}startDialog(e){if(!this.isDialogLaunched&&this.allowsTutorials){const{x:t,y:s}=this.getMiddleSceneCoordinates();this.textBox=new f(this,t,s),this.textBox.start(e),this.player.pause(),this.isDialogLaunched=!0}}checkForLevelEnd(){var e,t,s,i,r;if(this.player.x>((null===(e=this.end)||void 0===e?void 0:e.x)||0)-10&&this.player.x<((null===(t=this.end)||void 0===t?void 0:t.x)||0)+10&&this.player.y>((null===(s=this.end)||void 0===s?void 0:s.y)||0)-10&&this.player.y<((null===(i=this.end)||void 0===i?void 0:i.y)||0)+10&&this.player.enterActivate){const e=this.findPastPlayers((e=>!e.isDead));(null===(r=this.pastPlayersGroup)||void 0===r?void 0:r.getLength())>0&&e?(this.hasFx&&this.sound.play("door_tp"),this.player.setPosition(this.start.x,this.start.y)):(this.hasFx&&this.sound.play("end_level"),this.music.pause(),this.scene.start(this.nextScene))}}listenToPastPlayersEvents(){this.events.on("PastPlayer::init",(()=>{this.time.delayedCall(200,(()=>{this.doorExit.close()}))}),this),this.events.on("PastPlayer::isDead",(()=>{this.findPastPlayers((e=>!e.isDead))||this.time.delayedCall(200,(()=>{this.doorExit.open()}))}),this)}listenToPlayerEvents(){this.events.on("Player::shotBullet",(e=>{this.events.emit("BaseLevel::firstShotGun"),this.ballGroup.add(e),this.physics.add.collider([this.groundLayer],e,(()=>{e.destroy()}))}),this)}listenToMyTextBoxEvents(){this.events.on("MyTextBox::complete",(()=>{this.isDialogLaunched=!1,this.time.delayedCall(500,(()=>{this.player.resume()}))}),this)}shakeOnTpCollision(){this.cameras.main.shake(50,.01)}initDoors(){const{x:e,y:t}=this.tilemap.findObject(a.DOORS,(e=>e.name===r.DOOR_START)),{x:s,y:i}=this.tilemap.findObject(a.DOORS,(e=>e.name===r.DOOR_END));this.doorEntrance=new l(this,e||0,t||0),this.doorExit=new h(this,s||0,i||0),this.physics.add.collider([this.doorEntrance,this.doorExit],[this.groundLayer,this.platformsLayer])}initPastPlayers(){this.pastPlayersGroup=this.add.group(),this.physics.add.collider(this.pastPlayersGroup,[this.groundLayer,this.platformsLayer])}initMap(){this.tilemap=this.add.tilemap(this.tilesetKey),this.tileset=this.tilemap.addTilesetImage("tileset","tileset"),this.bckgLayer=this.tilemap.createLayer(a.BACKGROUND,this.tileset,0,0),this.groundLayer=this.tilemap.createLayer(a.GROUND,this.tileset,0,0),this.wallLayer=this.tilemap.createLayer(a.WALL,this.tileset,0,0),this.wall2Layer=this.tilemap.createLayer(a.WALL2,this.tileset,0,0),this.desksLayer=this.tilemap.createLayer(a.DESKS,this.tileset,0,0),this.platformsLayer=this.tilemap.createLayer(a.PLATFORMS,this.tileset,0,0),this.ceilingLayer=this.tilemap.createLayer(a.CEILING,this.tileset,0,0),this.lightsLayer=this.tilemap.createLayer(a.LIGHTS,this.tileset,0,0),this.groundLayer.setCollisionByProperty({collides:!0}),this.platformsLayer.setCollisionByProperty({collides:!0}),this.cameras.main.setBounds(0,0,this.tilemap.widthInPixels,this.tilemap.heightInPixels)}findObjectOnGroupByData(e,t){if((null==e?void 0:e.getLength())>0)return e.children.getArray().find((e=>Object.keys(t).every((s=>e.getData(s)===t[s]))));throw new Error(`Object not found with data ${JSON.stringify(t)}`)}iterateOnGroup(e,t){(null==e?void 0:e.getLength())>0&&e.children.iterate(t)}iterateOnPastPlayers(e){var t;(null===(t=this.pastPlayersGroup)||void 0===t?void 0:t.getLength())>0&&this.pastPlayersGroup.children.iterate(e)}findPastPlayers(e){var t;return(null===(t=this.pastPlayersGroup)||void 0===t?void 0:t.getLength())>0&&this.pastPlayersGroup.children.getArray().find(e)}intersect(e,t){return(0,Phaser.Geom.Intersects.RectangleToRectangle)(e.getBounds(),t.getBounds())}getObjectByLayerAndProperties(e,t){const s=this.tilemap.findObject(e,(e=>{const s=this.getPropertiesAsObject(e);return Object.keys(t).every((e=>s[e]===t[e]))}));if(!s)throw new Error(`Object with properties ${JSON.stringify(t)} not found in layer ${e}`);return s}getMiddleSceneCoordinates(){return{x:this.cameras.main.worldView.x+this.cameras.main.width/2,y:this.cameras.main.worldView.y+this.cameras.main.height/2}}checkForTutorials(){this.allowsTutorials&&this.dialogs.forEach(((e,t)=>{const{x:s,y:i}=JSON.parse(t);this.isDialogLaunched||this.player.x>(s||0)-10&&this.player.x<(s||0)+10&&this.player.y>(i||0)-10&&this.player.y<(i||0)+10&&(this.startDialog(e),this.dialogs.delete(t))}))}launchMusic(){this.music=this.sound.add("levels"),this.hasMusic&&!this.music.isPlaying&&(this.musicHasBeenPlayed=!0,this.music.play({loop:!0,volume:.1}))}getObjectsByLayerAndProperties(e,t){const s=this.tilemap.filterObjects(e,(e=>{const s=this.getPropertiesAsObject(e);return!!s&&Object.keys(t).every((e=>s[e]===t[e]))}));if(!s)throw new Error(`Objects with properties ${JSON.stringify(t)} not found in layer ${e}`);return s}getObjectByLayerAndName(e,t){const s=this.tilemap.findObject(e,(e=>e.name===t));if(!s)throw new Error(`Object with name ${t} not found in layer ${e}`);return s}getObjectsByLayerAndName(e,t){const s=this.tilemap.filterObjects(e,(e=>e.name===t));if(!s)throw new Error(`Objects with name ${t} not found in layer ${e}`);return s}getPropertiesAsObject(e){return e.properties?e.properties.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.name]:t.value})),{}):null}initAllowsTutorialsOption(){const e=this.store.get("tutorials");null!==e&&(this.allowsTutorials=e),null===e&&(this.allowsTutorials=!0)}listenToTutorialsSwitcherEvents(){this.events.on("TutorialsSwitcher::tutorials",(e=>{this.allowsTutorials=e}))}}class P extends Phaser.Scene{constructor(){super({key:i.PreloadStartScreen})}preload(){this.load.scenePlugin({key:"rexUI",sceneKey:"rexUI"}),this.load.image("nextPage","assets/img/ui/arrow-down-left.png"),this.load.image("dialogEnd","assets/img/ui/cancel.png"),this.load.audio("death","assets/sounds/death.wav"),this.load.audio("door_tp","assets/sounds/door_tp.wav"),this.load.audio("simple_gun_shot","assets/sounds/simple_gun_shot.wav"),this.load.audio("levels","assets/sounds/levels.wav"),this.load.audio("tp","assets/sounds/tp.wav"),this.load.audio("walk","assets/sounds/walk.wav"),this.load.audio("switcher","assets/sounds/switcher.wav"),this.load.audio("door_open","assets/sounds/door_open.wav"),this.load.audio("door_close","assets/sounds/door_close.wav"),this.load.audio("end_level","assets/sounds/end_level.wav"),this.load.bitmapFont("pixels","assets/fonts/pixels.png","assets/fonts/pixels.xml.fnt"),this.load.image("tileset","assets/img/tileset.png"),this.load.image("title","assets/img/logo-1200-3.png"),this.load.image("door_start","assets/img/objects/door_start.png"),this.load.image("door_end_open","assets/img/objects/door_end_open.png"),this.load.image("door_end_close","assets/img/objects/door_end_close.png"),this.load.image("door_tp","assets/img/objects/door_tp.png"),this.load.image("door_tp_red","assets/img/objects/door_tp_red.png"),this.load.image("door_tp_green","assets/img/objects/door_tp_green.png"),this.load.image("tp_red","assets/img/objects/tp_red.png"),this.load.image("tp_red_close","assets/img/objects/tp_red_close.png"),this.load.image("tp_orange","assets/img/objects/tp_orange.png"),this.load.image("tp_orange_close","assets/img/objects/tp_orange_close.png"),this.load.image("tp_green","assets/img/objects/tp_green.png"),this.load.image("tp_green_close","assets/img/objects/tp_green_close.png"),this.load.image("switcher_red","assets/img/objects/switcher_red.png"),this.load.image("switcher_green","assets/img/objects/switcher_green.png"),this.load.image("switcher_orange","assets/img/objects/switcher_orange.png"),this.load.image("bool_white_on","assets/img/objects/bool_white_on.png"),this.load.image("bool_white_off","assets/img/objects/bool_white_off.png"),this.load.tilemapTiledJSON("tileset","assets/json/levels/game-screen.json"),this.load.atlas("player","assets/img/chars/player_atlas.png","assets/json/chars/player_atlas.json"),this.load.atlas("simple_bullet","assets/img/objects/simple_bullet_atlas.png","assets/json/objects/simple_bullet_atlas.json"),this.load.atlas("simple_gun_shot","assets/img/particles/simple_gun_shot.png","assets/json/particles/simple_gun_shot.json")}create(){this.scene.start(i.StartScreen)}}class E extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s,i,r){super(e,t,s,i?"bool_white_on":"bool_white_off"),this.textContent=r,this.nextActivability=0,this.activabilityRate=500,this.isOn=i,e.add.existing(this)}create(){this.resolveState()}switch(){this.isOn=!this.isOn,this.resolveState(),this.scene.store.get("fx")&&this.scene.sound.play("switcher")}resolveState(){this.text&&this.text.destroy(),this.text=this.scene.add.text(Math.round(this.x),Math.round(this.y-30),this.textContent,{fontFamily:"Pixels",align:"left"}).setScale(1).setFontSize(15).setResolution(10).setOrigin(.5,.5),this.isOn&&(this.text.setColor("blue").setAlpha(1),this.setTexture("bool_white_on")),this.isOn||(this.text.setColor("red").setAlpha(.2),this.setTexture("bool_white_off"))}}class A extends E{constructor(e,t,s){const i=e.store.get("lang");super(e,t,s,null!==i&&"en"===i,"EN"),this.create()}create(){super.create(),this.scene.events.on("StartScreen::switchEn",(()=>{this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.switch(),this.scene.events.emit("StartScreen::switchFr"),this.isOn&&this.scene.store.set("lang","en"))}))}}class C extends E{constructor(e,t,s){const i=e.store.get("lang");super(e,t,s,null===i||"fr"===i,"FR"),this.create()}create(){super.create(),this.scene.events.on("StartScreen::switchFr",(()=>{this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.switch(),this.scene.events.emit("StartScreen::switchEn"),this.isOn&&this.scene.store.set("lang","fr"))}))}}class B extends E{constructor(e,t,s){const i=e.store.get("music");super(e,t,s,null==i||i,"MUSIC"),this.create()}create(){super.create(),this.scene.events.on("StartScreen::switchMusic",(()=>{this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.switch(),this.scene.store.set("music",this.isOn),this.scene.events.emit("MusicSwitcher::music",this.isOn))}))}}class j extends E{constructor(e,t,s){const i=e.store.get("fx");super(e,t,s,null==i||i,"FX"),this.create()}create(){super.create(),this.scene.events.on("StartScreen::switchFx",(()=>{this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.switch(),this.scene.store.set("fx",this.isOn),this.scene.events.emit("SoundSwitcher::fx",this.isOn))}))}}class R extends E{constructor(e,t,s){const i=e.store.get("tutorials");super(e,t,s,null==i||i,"TUTORIALS"),this.create()}create(){super.create(),this.scene.events.on("StartScreen::switchTutorials",(()=>{this.scene.time.now>this.nextActivability&&(this.nextActivability=this.scene.time.now+this.activabilityRate,this.switch(),this.scene.store.set("tutorials",this.isOn),this.scene.events.emit("TutorialsSwitcher::tutorials",this.isOn))}))}}class D extends Phaser.Scene{constructor(){super({key:i.StartScreen}),this.dialogs=new Map,this.isDialogLaunched=!1,this.nextScene=i.PreloadLevel1,this.tilesetKey="tileset"}create(){this.ballGroup=this.add.group(),this.initMap(),this.buildWhiteSwitchers(),this.initStartNewGame(),this.initContinueGame(),this.listenToPlayerEvents(),this.listenToMyTextBoxEvents(),this.initPlayer(),this.launchMusic(),this.addDialog(0,"Bienvenue dans mon super jeu :) Pour activer ou désactiver une option, positionnez-vous devant l'interrupteur et appuyez sur ENTRÉE."),this.initAllowsTutorialsOption(),this.listenToMusicSwitcherEvents(),this.listenToTutorialsSwitcherEvents()}update(){this.player.update(),this.checkForTutorials(),this.checkForLevelEnd(),this.checkForOptions(),this.checkStartNewGame(),this.checkContinueGame()}initContinueGame(){const e=this.getObjectByLayerAndName(a.OPTIONS,"continue");e&&(this.continueGameCoordinates={x:e.x,y:e.y},this.add.text(Math.round(this.continueGameCoordinates.x),Math.round(this.continueGameCoordinates.y-40),"CONTINUE",{fontFamily:"Pixels",align:"left"}).setScale(1).setFontSize(15).setResolution(10).setOrigin(.5,.5).setColor("blue"))}initStartNewGame(){const e=this.getObjectByLayerAndName(a.OPTIONS,"start");e&&(this.startNewGameCoordinates={x:e.x,y:e.y},this.add.text(Math.round(this.startNewGameCoordinates.x),Math.round(this.startNewGameCoordinates.y-40),"NEW GAME",{fontFamily:"Pixels",align:"left"}).setScale(1).setFontSize(15).setResolution(10).setOrigin(.5,.5).setColor("blue"))}buildWhiteSwitchers(){var e,t;const s=this.getObjectsByLayerAndName(a.OPTIONS,"bool-white");if(s.length>0)for(const i of s)switch(this.getPropertiesAsObject(i).name){case"music":this.musicSwitcherCoordinates={x:i.x,y:i.y},new B(this,(null==i?void 0:i.x)||0,(null==i?void 0:i.y)||0);break;case"sound":this.soundSwitcherCoordinates={x:i.x,y:i.y},new j(this,(null==i?void 0:i.x)||0,(null==i?void 0:i.y)||0);break;case"fr":this.frSwitcherCoordinates={x:i.x,y:i.y},new C(this,(null==i?void 0:i.x)||0,(null==i?void 0:i.y)||0);break;case"en":this.enSwitcherCoordinates={x:i.x,y:i.y},new A(this,(null==i?void 0:i.x)||0,(null==i?void 0:i.y)||0);break;case"tutorials":this.tutorialsSwitcherCoordinates={x:null!==(e=i.x)&&void 0!==e?e:0,y:null!==(t=i.y)&&void 0!==t?t:0},new R(this,(null==i?void 0:i.x)||0,(null==i?void 0:i.y)||0)}}checkStartNewGame(){this.playerIsNearCoordinates(this.startNewGameCoordinates)&&this.player.enterActivate&&(this.music.pause(),this.scene.start(i.PreloadLevel1))}checkContinueGame(){const e=this.store.get("level");e&&this.playerIsNearCoordinates(this.continueGameCoordinates)&&this.player.enterActivate&&(this.music.pause(),this.scene.start(e))}checkForOptions(){this.playerIsNearCoordinates(this.musicSwitcherCoordinates)&&this.player.enterActivate&&this.events.emit("StartScreen::switchMusic"),this.playerIsNearCoordinates(this.soundSwitcherCoordinates)&&this.player.enterActivate&&this.events.emit("StartScreen::switchFx"),this.playerIsNearCoordinates(this.frSwitcherCoordinates)&&this.player.enterActivate&&this.events.emit("StartScreen::switchFr"),this.playerIsNearCoordinates(this.enSwitcherCoordinates)&&this.player.enterActivate&&this.events.emit("StartScreen::switchEn"),this.playerIsNearCoordinates(this.tutorialsSwitcherCoordinates)&&this.player.enterActivate&&this.events.emit("StartScreen::switchTutorials")}initPlayer(){var e,t;this.start=this.tilemap.findObject(a.PLAYER,(e=>e.name===r.START)),this.end=this.tilemap.findObject(a.DOORS,(e=>e.name===r.END)),this.player=new g(this,(null===(e=this.start)||void 0===e?void 0:e.x)||0,(null===(t=this.start)||void 0===t?void 0:t.y)||0),this.player.create(),this.cameras.main.startFollow(this.player),this.physics.add.collider(this.player,[this.groundLayer,this.platformsLayer])}addDialog(e,t){const{x:s,y:i}=this.tilemap.findObject("dialogs",(t=>t.properties[0].value===e));this.dialogs.set(JSON.stringify({x:s,y:i}),t)}startDialog(e){if(!this.isDialogLaunched){const{x:t,y:s}=this.getMiddleSceneCoordinates();this.textBox=new f(this,t,s),this.textBox.start(e),this.player.pause(),this.isDialogLaunched=!0}}checkForLevelEnd(){var e,t,s,i;this.player.x>((null===(e=this.end)||void 0===e?void 0:e.x)||0)-10&&this.player.x<((null===(t=this.end)||void 0===t?void 0:t.x)||0)+10&&this.player.y>((null===(s=this.end)||void 0===s?void 0:s.y)||0)-10&&this.player.y<((null===(i=this.end)||void 0===i?void 0:i.y)||0)+10&&this.player.enterActivate&&(this.sound.play("end_level"),this.music.pause(),this.scene.start(this.nextScene))}listenToPlayerEvents(){this.events.on("Player::shotBullet",(e=>{this.events.emit("StartScreen::firstShotGun"),this.ballGroup.add(e),this.physics.add.collider([this.groundLayer],e,(()=>{e.destroy()}))}),this)}listenToMyTextBoxEvents(){this.events.on("MyTextBox::complete",(()=>{this.isDialogLaunched=!1,this.time.delayedCall(500,(()=>{this.player.resume()}))}),this)}initMap(){this.tilemap=this.add.tilemap(this.tilesetKey),this.tileset=this.tilemap.addTilesetImage("tileset","tileset");const e=this.tilemap.addTilesetImage("title","title");this.bckgLayer=this.tilemap.createLayer(a.BACKGROUND,this.tileset,0,0),this.groundLayer=this.tilemap.createLayer(a.GROUND,this.tileset,0,0),this.wallLayer=this.tilemap.createLayer(a.WALL,this.tileset,0,0),this.wall2Layer=this.tilemap.createLayer(a.WALL2,this.tileset,0,0),this.desksLayer=this.tilemap.createLayer(a.DESKS,this.tileset,0,0),this.platformsLayer=this.tilemap.createLayer(a.PLATFORMS,this.tileset,0,0),this.ceilingLayer=this.tilemap.createLayer(a.CEILING,this.tileset,0,0),this.lightsLayer=this.tilemap.createLayer(a.LIGHTS,this.tileset,0,0),this.optionsLayer=this.tilemap.createLayer(a.OPTIONS,this.tileset,0,0),this.tpLayer=this.tilemap.createLayer(a.TP,this.tileset,0,0),this.titleLayer=this.tilemap.createLayer(a.TITLE,[this.tileset,e],0,0),this.groundLayer.setCollisionByProperty({collides:!0}),this.platformsLayer.setCollisionByProperty({collides:!0}),this.cameras.main.setBounds(0,0,this.tilemap.widthInPixels,this.tilemap.heightInPixels)}playerIsNearCoordinates(e,t=10){return this.player.x>(e.x||0)-t&&this.player.x<(e.x||0)+t&&this.player.y>(e.y||0)-t&&this.player.y<(e.y||0)+t}checkForTutorials(){this.allowsTutorials&&this.dialogs.forEach(((e,t)=>{const{x:s,y:i}=JSON.parse(t);this.isDialogLaunched||this.player.x>(s||0)-10&&this.player.x<(s||0)+10&&this.player.y>(i||0)-10&&this.player.y<(i||0)+10&&(this.startDialog(e),this.dialogs.delete(t))}))}launchMusic(){var e;const t=null===(e=this.store.get("music"))||void 0===e||e;this.music=this.sound.add("levels"),t&&!this.music.isPlaying&&this.music.play({loop:!0,volume:.1})}getObjectByLayerAndName(e,t){const s=this.tilemap.findObject(e,(e=>e.name===t));if(!s)throw new Error(`Object with name ${t} not found in layer ${e}`);return s}getObjectsByLayerAndName(e,t){const s=this.tilemap.filterObjects(e,(e=>e.name===t));if(!s)throw new Error(`Objects with name ${t} not found in layer ${e}`);return s}getPropertiesAsObject(e){return e.properties?e.properties.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.name]:t.value})),{}):null}listenToMusicSwitcherEvents(){this.events.on("MusicSwitcher::music",(e=>{e||this.music.pause(),e&&this.music.resume()}))}initAllowsTutorialsOption(){const e=this.store.get("tutorials");null!==e&&(this.allowsTutorials=e),null===e&&(this.allowsTutorials=!0)}listenToTutorialsSwitcherEvents(){this.events.on("TutorialsSwitcher::tutorials",(e=>{this.allowsTutorials=e}))}getMiddleSceneCoordinates(){return{x:this.cameras.main.worldView.x+this.cameras.main.width/2,y:this.cameras.main.worldView.y+this.cameras.main.height/2}}}class N extends Phaser.Plugins.ScenePlugin{constructor(e,t){super(e,t,"store"),this.prefix="paradoxe-game."}set(e,t){localStorage.setItem(this.prefix+e,JSON.stringify(t)),this.scene.events.emit("Store::"+e,t)}get(e){const t=localStorage.getItem(this.prefix+e);return t?JSON.parse(t):null}}const M={type:Phaser.AUTO,backgroundColor:"#ffffff",antialias:!1,scale:{parent:"phaser-game",mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,width:1280,height:480},scene:[P,class extends n{constructor(){super(i.PreloadLevel1,i.Level1,"level1")}preload(){super.preload()}create(){super.create()}},class extends n{constructor(){super(i.PreloadLevel7,i.Level7,"level7")}preload(){super.preload()}create(){super.create()}},class extends n{constructor(){super(i.PreloadLevel6,i.Level6,"level6")}preload(){super.preload()}create(){super.create()}},class extends n{constructor(){super(i.PreloadLevel5,i.Level5,"level5")}preload(){super.preload()}create(){super.create()}},class extends n{constructor(){super(i.PreloadLevel2,i.Level2,"level2")}preload(){super.preload()}create(){super.create()}},class extends n{constructor(){super(i.PreloadLevel4,i.Level4,"level4")}preload(){super.preload()}create(){super.create()}},class extends n{constructor(){super(i.PreloadLevel3,i.Level3,"level3")}preload(){super.preload()}create(){super.create()}},D,class extends L{constructor(){super(i.Level1,i.PreloadLevel2,"level1")}create(){super.create(),this.addDialog(0,"Bonjour détective, merci d'être intervenu aussi rapidement. Le meurtre du professeur Colder est vraiment dramatique.\nPardon, je ne me suis pas présenté : Je suis Bob, l'IA de ce laboratoire. Je vais vous guider jusqu'au lieu du crime, dans la salle 823.\nPour passer d'une salle à l'autre, veuillez vous diriger vers la porte de sortie. C'est aussi simple que ça."),this.addDialog(1,"Une fois positionné, appuyez sur ENTRÉE pour passer à la salle suivante."),this.initPlayer()}update(){super.update()}},class extends L{constructor(){super(i.Level2,i.PreloadLevel3,"level2")}create(){super.create(),this.createSpatialTeleportersByColorAndNum("green",0),this.createSpatialTeleportersByColorAndNum("green",1),this.addDialog(0,"Félicitations détective. Vous faites honneur à votre profession.\nDans cette salle, pour accèder à la sortie veuillez empruntez le portail qui se trouve à l'autre bout de la salle."),this.addDialog(1,"Une fois positionné, appuyez sur ENTRÉE pour être téléporté sur la plateforme supérieure.\nOui oui, vous avez bien entendu : vous allez être téléporté. Notre laboratoire expérimente les voyages spatiaux, ceux-ci incluant les portails de téléportation.\n...\n...\nN'ayez pas peur, nous savons ce que nous faisons."),this.initPlayer()}update(){super.update(),this.checkForSpatialTeleportersActivation()}},class extends L{constructor(){super(i.Level3,i.PreloadLevel4,"level3"),this.firstTpTaken=!1,this.firstShotGun=!1}create(){super.create(),this.createSimpleTimeTeleporter(),this.createSimpleSwitcher(),this.createSpatialTeleportersByColorAndNum("green",0),this.createSpatialTeleportersByColorAndNum("green",1),this.initPlayer(),this.initSimpleTimeTeleporterObjectsColliders(),this.initSimpleTimeTeleporterWorldColliders(),this.events.on("BaseLevel::firstTp",(()=>{this.firstTpTaken||(this.firstTpTaken=!0,this.startDialog("ALERT ! ALERTE ! PARADOXE TEMPORELLE DÉTECTÉE ! PROTOCOLE DE SÉCURITÉ ENCLANCHÉ !\nPardon détective, je m'emporte. Il semblerait qu'il y ait eu comme un léger... bug...\nCes nouveaux types de portails sont encore en cours d'expérimentation. Pour accroître l'efficacité de notre technologie révolutionnaire, nous expérimentons la téléportation spatiale ET temporelle.\nDurant votre téléportation, vous auriez dû faire un saut de 2 secondes dans le futur. Mais il semblerait que vous ayez fait un saut de 2 secondes DANS LE PASSÉ !\nNe me regardez pas comme ça détective, nous sommes un laboratoire d'expérimentations après tout !\nCe saut dans le temps a créé une paradoxe temporelle : comme vous pouvez le voir, votre ... vous du passé se trouve encore de l'autre côté du portail.\nWoooooh il semble très en colère lui aussi.\nNotre protocole de sécurité implique de verrouiller la porte de sortie de cette salle. Si vous empruntez malgré tout cette porte, elle vous téléportera à l'entrée de la salle.\nNous débloqueront donc la sortie lorsque vous vous serez débarassé de votre vous du passé.\n...\n...\nOui, je parle bien de l'assassiner... le descendre... le refroidir...\n...\n...\nOk ok, vous avez saisi.\nOui, c'est un peu... radical. Mais les paradoxes temporelles sont bien pires qu'un petit meurtre, vous en conviendrez.\nPour vous servir de votre arme, appuyez sur ESPACE. Mais je ne vous apprends rien, détective.\nJe vous laisse donc essayer votre arme de service."))})),this.events.on("BaseLevel::firstShotGun",(()=>{this.firstTpTaken&&!this.firstShotGun&&this.time.delayedCall(1e3,(()=>{this.firstShotGun=!0,this.startDialog("Joli tir détective, je suis impressionné !\n...\nOh j'oubliais, le bouton vert au-dessus de vous permet de désactiver les portails verts. Une fois positionné devant, appuyez sur ENTRÉE pour activer le bouton.\n...\n...\nOui maintenant que j'y pense, nous aurions peut-être dû mettre des boutons verts un peu partout. Je vais noter ça dans notre todo list.")}))})),this.addDialog(0,"Vous êtes vraiment un détective très intelligent, détective.\nDans cette salle, nous expérimentons un nouveau type de portails. Plus rapides, plus performants, plus cool !\nEn traversant le portail vert en face de vous, vous allez être téléporté de l'autre côté.\n...\n...\nJe sais que ce n'est pas grand chose, mais il fallait bien que nous commencions les expérimentations quelque part.\n...\n...\nFaites-nous confiance, nous sommes des ingénieurs.")}update(){super.update(),this.checkForSpatialTeleportersActivation(),this.checkForSimpleSwitcherActivation()}},class extends L{constructor(){super(i.Level4,i.PreloadLevel5,"level4")}create(){super.create(),this.createDoubleTimeTeleporters(),this.createDoubleSwitcher(),this.createSpatialTeleportersByColorAndNum("green",0),this.createSpatialTeleportersByColorAndNum("green",1),this.initPlayer(),this.initDoubleTimeTeleportersObjectsColliders(),this.initDoubleTimeTeleportersWorldColliders(),this.addDialog(0,"Eh bien détective, vous faites un fabuleux sujet d'expér... heu... je voulais dire un fabuleux représentant de la justice !\nLe téléporteur rouge en face de vous va vous envoyer de l'autre côté du second téléporteur rouge.\n...\n...\nGare aux paradoxes !")}update(){super.update(),this.checkForSpatialTeleportersActivation(),this.checkForDoubleSwitcherActivation()}},class extends L{constructor(){super(i.Level5,i.PreloadLevel6,"level5")}create(){super.create(),this.createDoubleTimeTeleporters(),this.createDoubleSwitcher(),this.createSimpleTimeTeleporter(),this.createSimpleSwitcher(),this.createSpatialTeleportersByColorAndNum("green",0),this.createSpatialTeleportersByColorAndNum("green",1),this.initPlayer(),this.initSimpleTimeTeleporterWorldColliders(),this.initSimpleTimeTeleporterObjectsColliders(),this.initDoubleTimeTeleportersObjectsColliders(),this.initDoubleTimeTeleportersWorldColliders()}update(){super.update(),this.checkForSpatialTeleportersActivation(),this.checkForSimpleSwitcherActivation(),this.checkForDoubleSwitcherActivation()}},class extends L{constructor(){super(i.Level6,i.PreloadLevel7,"level6")}create(){super.create(),this.createMultiTimeTeleporterByNum(0),this.createMultiTimeTeleporterByNum(1),this.createMultiTimeTeleporterByNum(2),this.createMultiSwitcherByNum(0),this.createMultiSwitcherByNum(1),this.createMultiSwitcherByNum(2),this.createSpatialTeleportersByColorAndNum("green",0),this.createSpatialTeleportersByColorAndNum("green",1),this.createSpatialTeleportersByColorAndNum("red",0),this.createSpatialTeleportersByColorAndNum("red",1),this.initPlayer(),this.initMultiTimeTeleportersObjectsCollidersByNum(0),this.initMultiTimeTeleportersObjectsCollidersByNum(1),this.initMultiTimeTeleportersObjectsCollidersByNum(2),this.initMultiTimeTeleportersWorldColliders(),this.closeMultiTimeTeleporters(),this.initMultiTimeTeleportersOpposites(),this.listenToMultiTimeTeleportersEvents(),this.addDialog(0,"Je suis très fier de vous détective ! Vous vous en sortez très bien !\n...\n...\nMais... je sens que vous êtes un peu en colère. Vous devriez respirer profondément, un cerveau aussi brillant que le vôtre mérite d'être suffisament oxygéné."),this.addDialog(1,"Vous voyez ces portails orange ?\n...\n...\nParfait, vous avez une excellente vue.\nSi vous activez un des boutons orange, vous désactiverez les autres portails en alternance.\n...\n...\nBien, vous savez ce qu'ils vous restent à faire pour quitter cette salle.")}update(){super.update(),this.checkForSpatialTeleportersActivation(),this.checkForMultiSwitchersActivation()}},class extends L{constructor(){super(i.Level7,i.PreloadLevel1,"level7")}create(){super.create(),this.createDoubleTimeTeleporters(),this.createDoubleSwitcher(),this.createMultiTimeTeleporterByNum(0),this.createMultiTimeTeleporterByNum(1),this.createMultiTimeTeleporterByNum(2),this.createSimpleTimeTeleporter(),this.createSimpleSwitcher(),this.createMultiSwitcherByNum(0),this.createMultiSwitcherByNum(1),this.createMultiSwitcherByNum(2),this.createSpatialTeleportersByColorAndNum("green",0),this.createSpatialTeleportersByColorAndNum("green",1),this.createSpatialTeleportersByColorAndNum("red",0),this.createSpatialTeleportersByColorAndNum("red",1),this.initPlayer(),this.initMultiTimeTeleportersObjectsCollidersByNum(0),this.initMultiTimeTeleportersObjectsCollidersByNum(1),this.initMultiTimeTeleportersObjectsCollidersByNum(2),this.initMultiTimeTeleportersWorldColliders(),this.initSimpleTimeTeleporterWorldColliders(),this.initSimpleTimeTeleporterObjectsColliders(),this.initDoubleTimeTeleportersObjectsColliders(),this.initDoubleTimeTeleportersWorldColliders(),this.closeMultiTimeTeleporters(),this.initMultiTimeTeleportersOpposites(),this.listenToMultiTimeTeleportersEvents()}update(){super.update(),this.checkForSpatialTeleportersActivation(),this.checkForSimpleSwitcherActivation(),this.checkForDoubleSwitcherActivation(),this.checkForMultiSwitchersActivation()}}],physics:{default:"arcade",arcade:{debug:!1,gravity:{y:500}}},plugins:{scene:[{key:"rexUI",plugin:o.Z,mapping:"rexUI"},{key:"store",plugin:N,mapping:"store"}]}};window.addEventListener("load",(()=>{new Phaser.Game(M)}))},204:()=>{console.log("%c %c %c %c %c Built using phaser-project-template %c https://github.com/yandeu/phaser-project-template","background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none")}},s={};function i(e){var r=s[e];if(void 0!==r)return r.exports;var a=s[e]={exports:{}};return t[e].call(a.exports,a,a.exports,i),a.exports}i.m=t,e=[],i.O=(t,s,r,a)=>{if(!s){var o=1/0;for(c=0;c<e.length;c++){for(var[s,r,a]=e[c],n=!0,l=0;l<s.length;l++)(!1&a||o>=a)&&Object.keys(i.O).every((e=>i.O[e](s[l])))?s.splice(l--,1):(n=!1,a<o&&(o=a));if(n){e.splice(c--,1);var h=r();void 0!==h&&(t=h)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[s,r,a]},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={179:0};i.O.j=t=>0===e[t];var t=(t,s)=>{var r,a,[o,n,l]=s,h=0;if(o.some((t=>0!==e[t]))){for(r in n)i.o(n,r)&&(i.m[r]=n[r]);if(l)var c=l(i)}for(t&&t(s);h<o.length;h++)a=o[h],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(c)},s=self.webpackChunkparadoxe=self.webpackChunkparadoxe||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})(),i.O(void 0,[216],(()=>i(653)));var r=i.O(void 0,[216],(()=>i(204)));r=i.O(r)})();